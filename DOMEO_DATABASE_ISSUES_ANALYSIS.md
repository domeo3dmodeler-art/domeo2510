# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã DOMEO

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º

–ü–æ—Å–ª–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –∏ –¥–∞–Ω–Ω—ã—Ö –≤—ã—è–≤–ª–µ–Ω—ã **3 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã** —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö:

1. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –Ω–∞–∑–≤–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ**
2. **–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞**
3. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

---

## 1. –ü—Ä–æ–±–ª–µ–º–∞ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –Ω–∞–∑–≤–∞–Ω–∏–π —Å–≤–æ–π—Å—Ç–≤

### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∞ —Å–æ–∑–¥–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π –¥–ª—è –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —Å–≤–æ–π—Å—Ç–≤ —Ç–æ–≤–∞—Ä–æ–≤, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫:

- **–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö** - –æ–¥–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
- **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞** - API –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä—ã –ø–æ —Å–≤–æ–π—Å—Ç–≤–∞–º
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –ª–æ–≥–∏–∫–∏** - –∫–æ–¥ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

### –ü—Ä–∏–º–µ—Ä—ã –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

–ò–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –≤–∏–¥–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π:

```javascript
// –í app/api/admin/import/photos/route.ts (—Å—Ç—Ä–æ–∫–∏ 265-275)
const possibleKeys = [
  mappingProperty, // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–ª—é—á
  '–ê—Ä—Ç–∏–∫—É–ª –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
  '–ê—Ä—Ç–∏–∫—É–ª',
  'SKU',
  'sku',
  '–ê—Ä—Ç–∏–∫—É–ª_–ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
  '–ê—Ä—Ç–∏–∫—É–ª –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
  'Supplier SKU',
  'Supplier_sku'
];
```

### –ü—Ä–∏—á–∏–Ω—ã –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏** - –Ω–µ—Ç –µ–¥–∏–Ω–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ –Ω–∞–∑–≤–∞–Ω–∏–π —Å–≤–æ–π—Å—Ç–≤
2. **–†–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö** - –∏–º–ø–æ—Ä—Ç –∏–∑ Excel, CSV, API —Å —Ä–∞–∑–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏
3. **–†—É—á–Ω–æ–π –≤–≤–æ–¥** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–≤–æ–¥—è—Ç —Å–≤–æ–π—Å—Ç–≤–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É

- **API `/api/available-params`** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404 –æ—à–∏–±–∫–∏
- **–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤** —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ —Å–≤–æ–π—Å—Ç–≤–∞–º
- **–†–∞—Å—á–µ—Ç —Ü–µ–Ω** –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–∞–º–∏

---

## 2. –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–†—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ —Å–∏–º–≤–æ–ª—ã `??????`, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–µ—á–∏—Ç–∞–µ–º—ã–º–∏.

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º

```json
{
  "name": "?????? ????????????????",
  "properties_data": {
    "Domeo_???????????????? ???????????? ?????? Web": "DomeoDoors_Base_1",
    "??????????????????": "??????????????????",
    "?????? ??????????????????????": "??????????????????"
  }
}
```

### –ü—Ä–∏—á–∏–Ω—ã –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è

1. **SQLite –±–µ–∑ UTF-8** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–¥–∏—Ä–æ–≤–∫—É
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤** - –∏–º–ø–æ—Ä—Ç –∏–∑ Excel/CSV —Å –Ω–µ–≤–µ—Ä–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ charset –≤ API** - –æ—Ç–≤–µ—Ç—ã –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type
4. **–ü—Ä–æ–±–ª–µ–º—ã —Å Prisma** - ORM –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–¥–∏—Ä–æ–≤–∫—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: SQLite –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è UTF-8
- **API –æ—Ç–≤–µ—Ç—ã**: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç `charset=utf-8` –≤ Content-Type
- **–ò–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–æ–≤**: –Ω–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ Excel/CSV
- **Prisma —Å—Ö–µ–º–∞**: –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Unicode

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É

- **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è** –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –∏ —Å–≤–æ–π—Å—Ç–≤
- **–û—à–∏–±–∫–∏ –≤ API** - –ø–æ–∏—Å–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä—É—Å—Å–∫–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏
- **–ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π** - —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è
- **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω** - —Å–≤–æ–π—Å—Ç–≤–∞ –Ω–µ —á–∏—Ç–∞—é—Ç—Å—è

---

## 3. –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î –∏–º–µ–µ—Ç —Å–µ—Ä—å–µ–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 3.1 –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤

```sql
-- –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
properties_data String @default("{}") -- JSON –≤ —Å—Ç—Ä–æ–∫–µ
specifications String @default("{}")  -- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—è—Ö
- **–ù–µ—Ç –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏** - –ø–æ–∏—Å–∫ –ø–æ JSON —Å–≤–æ–π—Å—Ç–≤–∞–º –º–µ–¥–ª–µ–Ω–Ω—ã–π
- **–ü–∞—Ä—Å–∏–Ω–≥ –Ω–∞ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ** - JSON –ø–∞—Ä—Å–∏—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏
- **–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è

#### 3.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤

```sql
-- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è:
- properties_data (JSON –ø–æ–∏—Å–∫)
- specifications (JSON –ø–æ–∏—Å–∫)  
- catalog_category_id + is_active (—Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å)
- created_at, updated_at (–¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏)
```

#### 3.3 –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

```typescript
// –ü—Ä–∏–º–µ—Ä –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏–∑ app/api/catalog/doors/complete-data/route.ts
const products = await prisma.product.findMany({
  where: {
    catalog_category: {
      name: "–ú–µ–∂–∫–æ–º–Ω–∞—Ç–Ω—ã–µ –¥–≤–µ—Ä–∏"
    },
    is_active: true
  },
  select: {
    properties_data: true // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –ø–∞–º—è—Ç—å
  },
  take: 5000 // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ, –Ω–µ –≤ –ë–î
});
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- **–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤** –≤ –ø–∞–º—è—Ç—å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –∫–æ–¥–µ** –≤–º–µ—Å—Ç–æ SQL WHERE
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏** –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
- **–ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### 3.4 –ü—Ä–æ–±–ª–µ–º—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

```typescript
// –¢–µ–∫—É—â–µ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏
const completeDataCache = new Map<string, { data: any, timestamp: number }>();
const CACHE_TTL = 60 * 60 * 1000; // 1 —á–∞—Å
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- **–ö—ç—à –≤ –ø–∞–º—è—Ç–∏** - —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- **–ù–µ—Ç –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏** - –∫—ç—à –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Redis** - –Ω–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ù–µ—Ç –º–µ—Ç—Ä–∏–∫** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** - 3-4 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- **–í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏** - –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ RAM
- **–ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** - –∏–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º—É
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏** - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–æ—Å—Ç—É

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—à–µ–Ω–∏—é

### 1. –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤

#### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Å–≤–æ–π—Å—Ç–≤

```sql
-- –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–≤–æ–π—Å—Ç–≤
CREATE TABLE property_definitions (
  id VARCHAR(50) PRIMARY KEY,
  canonical_name VARCHAR(100) NOT NULL UNIQUE,
  display_name VARCHAR(100) NOT NULL,
  data_type VARCHAR(20) NOT NULL,
  is_required BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –¢–∞–±–ª–∏—Ü–∞ –º–∞–ø–ø–∏–Ω–≥–∞ –∞–ª–∏–∞—Å–æ–≤
CREATE TABLE property_aliases (
  id VARCHAR(50) PRIMARY KEY,
  property_id VARCHAR(50) REFERENCES property_definitions(id),
  alias_name VARCHAR(100) NOT NULL,
  source VARCHAR(50) NOT NULL, -- 'excel', 'csv', 'api', 'manual'
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 1.2 –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ

```typescript
// –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
async function normalizePropertyName(rawName: string, source: string): Promise<string> {
  // –ü–æ–∏—Å–∫ –≤ –∞–ª–∏–∞—Å–∞—Ö
  const alias = await prisma.propertyAlias.findFirst({
    where: {
      alias_name: { contains: rawName, mode: 'insensitive' },
      source: source
    },
    include: { property_definition: true }
  });
  
  return alias?.property_definition.canonical_name || rawName;
}
```

#### 1.3 –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ

```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
async function validateImportData(products: any[]): Promise<ValidationResult> {
  const errors = [];
  const propertyNames = new Set();
  
  for (const product of products) {
    for (const [key, value] of Object.entries(product.properties_data)) {
      const normalizedKey = await normalizePropertyName(key, 'import');
      
      if (propertyNames.has(normalizedKey)) {
        errors.push(`–î—É–±–ª–∏—Ä—É—é—â–µ–µ—Å—è —Å–≤–æ–π—Å—Ç–≤–æ: ${key} -> ${normalizedKey}`);
      }
      
      propertyNames.add(normalizedKey);
    }
  }
  
  return { isValid: errors.length === 0, errors };
}
```

### 2. –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π

#### 2.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SQLite

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
PRAGMA encoding = "UTF-8";
PRAGMA foreign_keys = ON;
```

#### 2.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Prisma —Å—Ö–µ–º—ã

```prisma
datasource db {
  provider = "sqlite"
  url      = "file:./database/dev.db"
  // –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏
}

model Product {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  name String // UTF-8 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  properties_data String @default("{}") // UTF-8 JSON
}
```

#### 2.3 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –æ—Ç–≤–µ—Ç–æ–≤

```typescript
// –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type –¥–ª—è –≤—Å–µ—Ö API
export function createResponse(data: any) {
  const response = NextResponse.json(data);
  response.headers.set('Content-Type', 'application/json; charset=utf-8');
  return response;
}
```

#### 2.4 –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –∏–º–ø–æ—Ä—Ç–∞

```typescript
// –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
import * as XLSX from 'xlsx';

function readExcelFile(buffer: Buffer): any[] {
  const workbook = XLSX.read(buffer, { 
    type: 'buffer',
    codepage: 65001 // UTF-8
  });
  
  const sheet = workbook.Sheets[workbook.SheetNames[0]];
  return XLSX.utils.sheet_to_json(sheet, { 
    defval: '',
    raw: false // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç—Ä–æ–∫–∏
  });
}
```

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ë–î

#### 3.1 –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

```sql
-- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤
CREATE TABLE products_optimized (
  id VARCHAR(50) PRIMARY KEY,
  catalog_category_id VARCHAR(50) NOT NULL,
  sku VARCHAR(100) NOT NULL UNIQUE,
  name VARCHAR(255) NOT NULL,
  base_price DECIMAL(10,2) NOT NULL,
  stock_quantity INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  
  -- –ò–Ω–¥–µ–∫—Å—ã
  INDEX idx_category_active (catalog_category_id, is_active),
  INDEX idx_sku (sku),
  INDEX idx_name (name),
  INDEX idx_created_at (created_at)
);

-- –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–≤–æ–π—Å—Ç–≤
CREATE TABLE product_properties (
  id VARCHAR(50) PRIMARY KEY,
  product_id VARCHAR(50) NOT NULL,
  property_name VARCHAR(100) NOT NULL,
  property_value TEXT NOT NULL,
  property_type VARCHAR(20) DEFAULT 'text',
  
  FOREIGN KEY (product_id) REFERENCES products_optimized(id) ON DELETE CASCADE,
  INDEX idx_product_property (product_id, property_name),
  INDEX idx_property_value (property_name, property_value)
);
```

#### 3.2 –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

```typescript
// –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
async function getProductsPaginated(params: {
  categoryId?: string;
  page: number;
  limit: number;
  filters?: Record<string, any>;
}) {
  const where: any = { is_active: true };
  
  if (params.categoryId) {
    where.catalog_category_id = params.categoryId;
  }
  
  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
  if (params.filters) {
    for (const [key, value] of Object.entries(params.filters)) {
      where.properties = {
        some: {
          property_name: key,
          property_value: { contains: value }
        }
      };
    }
  }
  
  const [products, total] = await Promise.all([
    prisma.product.findMany({
      where,
      include: {
        properties: true,
        catalog_category: {
          select: { id: true, name: true }
        }
      },
      skip: (params.page - 1) * params.limit,
      take: params.limit,
      orderBy: { created_at: 'desc' }
    }),
    prisma.product.count({ where })
  ]);
  
  return { products, total, page: params.page, limit: params.limit };
}
```

#### 3.3 –°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
// Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
import Redis from 'ioredis';

const redis = new Redis({
  host: process.env.REDIS_HOST || 'localhost',
  port: parseInt(process.env.REDIS_PORT || '6379'),
  retryDelayOnFailover: 100,
  maxRetriesPerRequest: 3
});

class CacheService {
  async get<T>(key: string): Promise<T | null> {
    const cached = await redis.get(key);
    return cached ? JSON.parse(cached) : null;
  }
  
  async set<T>(key: string, data: T, ttl: number = 3600): Promise<void> {
    await redis.setex(key, ttl, JSON.stringify(data));
  }
  
  async invalidate(pattern: string): Promise<void> {
    const keys = await redis.keys(pattern);
    if (keys.length > 0) {
      await redis.del(...keys);
    }
  }
}
```

#### 3.4 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```typescript
// –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
class DatabaseMetrics {
  static async measureQuery<T>(
    queryName: string,
    queryFn: () => Promise<T>
  ): Promise<T> {
    const startTime = Date.now();
    
    try {
      const result = await queryFn();
      const duration = Date.now() - startTime;
      
      // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
      if (duration > 1000) {
        console.warn(`Slow query: ${queryName} took ${duration}ms`);
      }
      
      // –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ—Ç—Ä–∏–∫
      await this.sendMetrics(queryName, duration, true);
      
      return result;
    } catch (error) {
      const duration = Date.now() - startTime;
      await this.sendMetrics(queryName, duration, false);
      throw error;
    }
  }
  
  private static async sendMetrics(
    queryName: string,
    duration: number,
    success: boolean
  ): Promise<void> {
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    console.log(`Query: ${queryName}, Duration: ${duration}ms, Success: ${success}`);
  }
}
```

---

## –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UTF-8 –≤ SQLite
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API –æ—Ç–≤–µ—Ç–æ–≤
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤

2. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–æ–π—Å—Ç–≤**
   - –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Å–≤–æ–π—Å—Ç–≤
   - –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏–º–ø–æ—Ä—Ç–∞

### –≠—Ç–∞–ø 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (2-3 –Ω–µ–¥–µ–ª–∏)

1. **–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î**
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
   - –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤

2. **–°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**
   - –í–Ω–µ–¥—Ä–µ–Ω–∏–µ Redis
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∞
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –≠—Ç–∞–ø 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 –Ω–µ–¥–µ–ª–∏)

1. **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
   - –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–∏—Ä–æ–≤–∫–∏
- ‚úÖ –†—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä—É—Å—Å–∫–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏
- ‚úÖ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Ç–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ

### –ü–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–≤–æ–π—Å—Ç–≤
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ API

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚ö° –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 5-10 —Ä–∞–∑
- üìà –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤
- üîÑ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —è–≤–ª—è—é—Ç—Å—è **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏** –∏ —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è. –û–Ω–∏ –≤–ª–∏—è—é—Ç –Ω–∞:

- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã** - –ø–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –≤—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–æ—Å—Ç—É
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç** - –Ω–µ—á–∏—Ç–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—à–∏–±–∫–∏ API

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å —Å **–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–∏—Ä–æ–≤–∫–∏** –∫–∞–∫ –Ω–∞–∏–±–æ–ª–µ–µ –∫—Ä–∏—Ç–∏—á–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ **–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–≤–æ–π—Å—Ç–≤** –∏ **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**.

–ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–Ω–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ–π, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–π –∏ –≥–æ—Ç–æ–≤–æ–π –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é.
