# –û—Ç—á–µ—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ò–∑–º–µ–Ω–µ–Ω SupplierOrder: orderId ‚Üí invoiceId
**–§–∞–π–ª—ã**:
- `app/api/supplier-orders/route.ts`
  - POST: `orderId` ‚Üí `invoiceId`
  - GET: `orderId` ‚Üí `invoiceId`
  - –°–æ–∑–¥–∞–Ω–∏–µ SupplierOrder —Ç–µ–ø–µ—Ä—å –Ω–∞–ø—Ä—è–º—É—é –æ—Ç Invoice (–±–µ–∑ Order)
  - `SupplierOrder.parent_document_id = Invoice.id`

### 2. –ó–∞–º–µ–Ω–µ–Ω—ã —Å—Ç–∞—Ç—É—Å—ã: IN_PRODUCTION ‚Üí ORDERED, READY ‚Üí RECEIVED_FROM_SUPPLIER
**–§–∞–π–ª—ã**:
- `app/api/invoices/[id]/status/route.ts`
  - –£–¥–∞–ª–µ–Ω `IN_PRODUCTION`
  - –î–æ–±–∞–≤–ª–µ–Ω `ORDERED`
- `app/api/supplier-orders/[id]/status/route.ts`
  - –£–¥–∞–ª–µ–Ω—ã `IN_PRODUCTION`, `READY`
  - –î–æ–±–∞–≤–ª–µ–Ω `RECEIVED_FROM_SUPPLIER`
- `lib/validation/status-transitions.ts`
  - –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ—Ö–æ–¥—ã –¥–ª—è invoice, order, supplier_order
- `lib/validation/status-blocking.ts`
  - –û–±–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã
- `lib/utils/status-labels.ts`
  - –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
**–§–∞–π–ª**: `app/api/supplier-orders/[id]/status/route.ts`
- –§—É–Ω–∫—Ü–∏—è `synchronizeDocumentStatuses` —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `invoiceId` –≤–º–µ—Å—Ç–æ `orderId`
- –£–±—Ä–∞–Ω Order –∏–∑ —Ü–µ–ø–æ—á–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è: Invoice –∏ Quote
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞

### 4. –°–æ–∑–¥–∞–Ω SQL –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
**–§–∞–π–ª**: `migrations/fix-status-names.sql`
- –ó–∞–º–µ–Ω—è–µ—Ç `IN_PRODUCTION` ‚Üí `ORDERED`
- –ó–∞–º–µ–Ω—è–µ—Ç `READY` ‚Üí `RECEIVED_FROM_SUPPLIER`
- –û–±–Ω–æ–≤–ª—è–µ—Ç Invoice, SupplierOrder, Quote, Order

## üìä –ù–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```
Quote ‚Üí Invoice ‚Üí SupplierOrder
```

**–°—Ç–∞—Ç—É—Å—ã Invoice**:
1. DRAFT - –ß–µ—Ä–Ω–æ–≤–∏–∫ (–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä)
2. SENT - –û—Ç–ø—Ä–∞–≤–ª–µ–Ω (–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä)
3. PAID - –û–ø–ª–∞—á–µ–Ω/–ó–∞–∫–∞–∑ (–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä) ‚ö†Ô∏è –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞
4. ORDERED - –ó–∞–∫–∞–∑ —Ä–∞–∑–º–µ—â–µ–Ω (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)
5. RECEIVED_FROM_SUPPLIER - –ü–æ–ª—É—á–µ–Ω –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)
6. COMPLETED - –ò—Å–ø–æ–ª–Ω–µ–Ω (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å) ‚ö†Ô∏è –ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
7. CANCELLED - –û—Ç–º–µ–Ω–µ–Ω

**–°—Ç–∞—Ç—É—Å—ã SupplierOrder**:
1. PENDING - –û–∂–∏–¥–∞–µ—Ç
2. ORDERED - –ó–∞–∫–∞–∑ —Ä–∞–∑–º–µ—â–µ–Ω
3. RECEIVED_FROM_SUPPLIER - –ü–æ–ª—É—á–µ–Ω –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
4. COMPLETED - –ò—Å–ø–æ–ª–Ω–µ–Ω
5. CANCELLED - –û—Ç–º–µ–Ω–µ–Ω

## üéØ –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞

### –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä (COMPLECTATOR)
- –î–æ—Å—Ç—É–ø –¥–æ `PAID` –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ
- –ü–æ—Å–ª–µ `PAID` –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã
- –ü–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

### –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (EXECUTOR)
- –°–æ–∑–¥–∞–µ—Ç SupplierOrder –æ—Ç Invoice
- –ú–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã: `ORDERED`, `RECEIVED_FROM_SUPPLIER`, `COMPLETED`
- –ü–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ `PAID`

### –ê–¥–º–∏–Ω (ADMIN)
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Å—Ç–∞—Ç—É—Å–∞–º
- –ú–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç–∞—Ç—É—Å—ã –Ω–∞–∑–∞–¥

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ**
   - –í—Å–µ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
   - –õ–∏–Ω—Ç–µ—Ä –æ—à–∏–±–æ–∫ –Ω–µ—Ç

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î**
   ```bash
   psql -d <database> -f migrations/fix-status-names.sql
   ```

3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å workflow**
   - –°–æ–∑–¥–∞–Ω–∏–µ Quote
   - –°–æ–∑–¥–∞–Ω–∏–µ Invoice –æ—Ç Quote
   - –°–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ PAID (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞)
   - –°–æ–∑–¥–∞–Ω–∏–µ SupplierOrder –æ—Ç Invoice (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º)
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

4. **–û–±–Ω–æ–≤–∏—Ç—å UI (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

- **–£–±—Ä–∞–Ω Order –∏–∑ —Ü–µ–ø–æ—á–∫–∏**: SupplierOrder —Ç–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –æ—Ç Invoice
- **–ó–∞–º–µ–Ω–µ–Ω—ã —Å—Ç–∞—Ç—É—Å—ã**: `IN_PRODUCTION` ‚Üí `ORDERED`, `READY` ‚Üí `RECEIVED_FROM_SUPPLIER`
- **–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø–æ—Å–ª–µ PAID**: —Ç–æ–ª—å–∫–æ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã
- **–°—Ç–∞—Ç—É—Å COMPLETED**: –ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –≤—Å–µ—Ö (–∫—Ä–æ–º–µ –ê–¥–º–∏–Ω–∞)

