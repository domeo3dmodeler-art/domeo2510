# üöÄ Onboarding –¥–ª—è –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞ - –ü—Ä–æ–µ–∫—Ç Domeo

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 2025-01-06  
**–í–µ—Ä—Å–∏—è**: 2.0

---

## üìã –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ü–†–û–ï–ö–¢–ê

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ñ–∞–∑—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

**–§–∞–∑–∞ 1-5: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (–∑–∞–≤–µ—Ä—à–µ–Ω–æ)**
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—è —Å–µ—Ä–≤–∏—Å–æ–≤ (DocumentService, ExportService)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ (DocumentRepository, ClientRepository, ProductRepository)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ç–∏–ø–∏–∑–∞—Ü–∏—è (Zod —Å—Ö–µ–º—ã, —É–±—Ä–∞–Ω—ã –≤—Å–µ `any`)
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (apiSuccess/apiError, –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫)

**–§–∞–∑–∞ 6: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ API routes (–∑–∞–≤–µ—Ä—à–µ–Ω–æ)**
- ‚úÖ –û—Ç—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–æ 24+ API routes –≤ `app/api/admin/`
- ‚úÖ –í—Å–µ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ `lib/` –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π `prisma`
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ `prisma.$disconnect()` –≤—ã–∑–æ–≤—ã
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ `console.log` –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `logger`
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã API –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–∑ `apiSuccess`/`apiError`

**–§–∞–∑–∞ 7: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–∑–∞–≤–µ—Ä—à–µ–Ω–æ)**
- ‚úÖ –í—Å–µ 10 –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π `prisma`
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `logger`
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: Next.js 15.5.6, React 19.2.0, TypeScript 5.5.4, Prisma 5.22.0
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL (production), SQLite (development)
- **API Routes**: 200+ endpoints
- **–û—Ç—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–æ**: 24+ API routes, 10 –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–£–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**: 500+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π**: 100% –∫–ª—é—á–µ–≤—ã—Ö –º–æ–¥—É–ª–µ–π

### üéØ –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–µ–≤ (API ‚Üí Service ‚Üí Repository ‚Üí Database)
2. **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏, —É–±—Ä–∞–Ω—ã –≤—Å–µ `any`
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤, –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `logger` –∏–∑ `lib/logging/logger.ts`
5. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ì–ª–æ–±–∞–ª—å–Ω—ã–π `prisma` —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–∑ `lib/prisma.ts`

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

### C4 Model - –£—Ä–æ–≤–Ω–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**–£—Ä–æ–≤–µ–Ω—å 1: System Context**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä, –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
    ‚Üì HTTPS
Domeo Platform (Next.js Web Application)
    ‚Üì
PostgreSQL Database | Yandex Object Storage | GitHub
```

**–£—Ä–æ–≤–µ–Ω—å 2: Container (–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)**
- **Web Application** (Next.js) - React UI, Server-Side Rendering
- **API Layer** (Next.js API Routes) - REST API, Authentication, Business Logic
- **Database** (PostgreSQL) - –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Prisma ORM

**–£—Ä–æ–≤–µ–Ω—å 3: Component (–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)**

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–æ–µ–≤:**
```
app/api/                    # API Routes (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã)
    ‚Üì
lib/services/               # Business Logic (—Å–µ—Ä–≤–∏—Å—ã)
    ‚Üì
lib/repositories/           # Data Access (—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
    ‚Üì
lib/prisma.ts              # Database (Prisma Client)
```

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1. **API Layer** (`app/api/`)
   - REST API endpoints
   - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ `requireAuth`/`requireAuthAndPermission`
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–∑ `apiSuccess`/`apiError`
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `withErrorHandling` HOC

2. **Service Layer** (`lib/services/`)
   - `DocumentService` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ (Order, Invoice, Quote)
   - `ExportService` - —ç–∫—Å–ø–æ—Ä—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (PDF, Excel, CSV)
   - `CatalogService` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ç–æ–≤–∞—Ä–æ–≤
   - `CatalogImportService` - –∏–º–ø–æ—Ä—Ç –∫–∞—Ç–∞–ª–æ–≥–∞
   - `SimpleImportService` - –ø—Ä–æ—Å—Ç–æ–π –∏–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤
   - `ProductPartialUpdateService` - —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
   - `DatabaseOptimizationService` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ë–î

3. **Repository Layer** (`lib/repositories/`)
   - `DocumentRepository` - —Ä–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
   - `ClientRepository` - —Ä–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
   - `ProductRepository` - —Ä–∞–±–æ—Ç–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏
   - `BaseRepository` - –±–∞–∑–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

4. **Validation Layer** (`lib/validation/`)
   - Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - Middleware –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

5. **Auth Layer** (`lib/auth/`)
   - JWT —Ç–æ–∫–µ–Ω—ã (`lib/auth/jwt.ts`)
   - Middleware –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`lib/auth/middleware.ts`)
   - Helpers –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`lib/auth/request-helpers.ts`)

6. **Logging** (`lib/logging/`)
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π `logger` –∏–∑ `lib/logging/logger.ts`
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
domeo/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API Routes (200+ endpoints)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/        # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ documents/    # API –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ export/       # API –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ admin/            # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îú‚îÄ‚îÄ complectator/     # –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ executor/         # –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ lib/                   # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ services/         # –°–µ—Ä–≤–∏—Å—ã (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ repositories/     # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (–¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º)
‚îÇ   ‚îú‚îÄ‚îÄ auth/             # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ validation/       # –í–∞–ª–∏–¥–∞—Ü–∏—è (Zod —Å—Ö–µ–º—ã)
‚îÇ   ‚îú‚îÄ‚îÄ api/              # API —É—Ç–∏–ª–∏—Ç—ã (response, errors)
‚îÇ   ‚îú‚îÄ‚îÄ logging/          # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ prisma.ts         # –ì–ª–æ–±–∞–ª—å–Ω—ã–π Prisma Client
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ prisma/                # Prisma —Å—Ö–µ–º—ã –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ scripts/               # –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –¥–µ–ø–ª–æ—è –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ docs/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ C4_ARCHITECTURE.md
‚îÇ   ‚îú‚îÄ‚îÄ ARCHITECTURE.md
‚îÇ   ‚îú‚îÄ‚îÄ REFACTORING_SUMMARY.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ docker-compose.*.yml   # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

---

## üîÑ –ü–ê–ô–ü–õ–ê–ô–ù –†–ê–ó–†–ê–ë–û–¢–ö–ò –ò –î–ï–ü–õ–û–Ø

### –°—Ö–µ–º–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```
–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (Windows)
    ‚Üì
git add + commit
    ‚Üì
git push origin develop
    ‚Üì
GitHub (—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: domeo3dmodeler-art/domeo2510)
    ‚Üì
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ staging –í–ú (git pull)
    ‚Üì
Hot Reload (–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
    ‚Üì
–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–Ω—ã –Ω–∞ http://130.193.40.35:3001
```

### –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

#### 1. –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

**–û–∫—Ä—É–∂–µ–Ω–∏–µ:**
- OS: Windows 10/11
- Node.js: 20.x
- IDE: VS Code / Cursor
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: SQLite (—á–µ—Ä–µ–∑ Prisma) –∏–ª–∏ PostgreSQL (—á–µ—Ä–µ–∑ SSH —Ç—É–Ω–Ω–µ–ª—å)

**–ö–æ–º–∞–Ω–¥—ã:**
```powershell
# –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞
npm run dev                    # –ü–æ—Ä—Ç 3000

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
npm run type-check

# –õ–∏–Ω—Ç–∏–Ω–≥
npm run lint

# –†–∞–±–æ—Ç–∞ —Å –ë–î
npm run prisma:studio          # Prisma Studio
npm run prisma:migrate         # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
```

#### 2. Git workflow

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–µ—Ç–∫–∏:**
- `develop` - staging/development (—Ç–µ–∫—É—â–∞—è —Ä–∞–±–æ—á–∞—è –≤–µ—Ç–∫–∞)
- `main` - production-ready –∫–æ–¥

**–ü—Ä–æ—Ü–µ—Å—Å –∫–æ–º–º–∏—Ç–∞ –∏ –ø—É—à–∞:**

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```powershell
# PowerShell —Å–∫—Ä–∏–ø—Ç (–¥–µ–ª–∞–µ—Ç –≤—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
.\scripts\git-sync-to-staging.ps1 "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ git
2. ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git add -A`)
3. ‚úÖ –°–æ–∑–¥–∞–µ—Ç –∫–æ–º–º–∏—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
4. ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ GitHub (`git push origin develop`)
5. ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–¥ –Ω–∞ staging –í–ú (`git pull`)
6. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è hot reload

**–†—É—á–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å:**
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
git add .
git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
git push origin develop
```

#### 3. Staging –í–ú (—Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞)

**–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –í–ú:**
- **IP**: 130.193.40.35
- **–ü–æ—Ä—Ç**: 3001
- **URL**: http://130.193.40.35:3001
- **SSH**: `ssh ubuntu@130.193.40.35`
- **–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞**: `/opt/domeo`
- **Docker Compose**: `docker-compose.staging-dev.yml`

**Hot Reload —Ä–µ–∂–∏–º:**
- ‚úÖ –í–µ—Å—å –∫–æ–¥ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ volume (`.:/app`)
- ‚úÖ Next.js –∑–∞–ø—É—â–µ–Ω –≤ dev —Ä–µ–∂–∏–º–µ (`npm run dev`)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ `git pull`
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ staging –í–ú:**

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç):**
```powershell
# –°–∫—Ä–∏–ø—Ç –¥–µ–ª–∞–µ—Ç git pull –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
.\scripts\git-sync-to-staging.ps1 "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
```

**–í—Ä—É—á–Ω—É—é:**
```bash
# SSH –Ω–∞ –í–ú
ssh ubuntu@130.193.40.35

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/domeo

# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin develop

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (hot reload)
docker compose -f docker-compose.staging-dev.yml restart staging-app

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞ –í–ú
./scripts/update-staging.sh
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health
curl http://130.193.40.35:3001/api/health

# –õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker compose -f docker-compose.staging-dev.yml logs --tail=50 staging-app

# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker-compose.staging-dev.yml ps
```

#### 4. Production (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ö–æ–¥ –≤ –≤–µ—Ç–∫–µ `main`
2. GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç
3. –ò–ª–∏ —Ä—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã

---

## üîß –ö–õ–Æ–ß–ï–í–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ –ò –ü–ê–¢–¢–ï–†–ù–´

### 1. API Routes - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω

```typescript
import { NextRequest } from 'next/server';
import { prisma } from '@/lib/prisma';
import { requireAuthAndPermission } from '@/lib/auth/middleware';
import { getAuthenticatedUser } from '@/lib/auth/request-helpers';
import { apiSuccess, apiError, ApiErrorCode, withErrorHandling } from '@/lib/api/response';
import { ValidationError } from '@/lib/api/errors';
import { logger } from '@/lib/logging/logger';

async function handler(req: NextRequest) {
  try {
    const user = await getAuthenticatedUser(req);
    
    // Business logic here
    
    return apiSuccess({ data: result });
  } catch (error) {
    logger.error('Error description', 'api/route', error instanceof Error ? { error: error.message } : { error: String(error) });
    if (error instanceof ValidationError) {
      throw error;
    }
    return apiError(ApiErrorCode.INTERNAL_SERVER_ERROR, 'Error message', 500);
  }
}

export const GET = withErrorHandling(
  requireAuthAndPermission('PERMISSION_NAME')
)(handler);
```

### 2. Service Layer - –ü—Ä–∏–º–µ—Ä

```typescript
import { prisma } from '@/lib/prisma';
import { logger } from '@/lib/logging/logger';
import { DocumentRepository } from '@/lib/repositories/document.repository';

export class DocumentService {
  private documentRepo: DocumentRepository;
  
  constructor() {
    this.documentRepo = new DocumentRepository(prisma);
  }
  
  async createDocument(data: CreateDocumentInput) {
    // Business logic here
    return await this.documentRepo.create(data);
  }
}
```

### 3. Repository Layer - –ü—Ä–∏–º–µ—Ä

```typescript
import { prisma } from '@/lib/prisma';
import { BaseRepository } from './base.repository';

export class DocumentRepository extends BaseRepository<Document, CreateInput, UpdateInput> {
  constructor(prisma: any) {
    super(prisma, 'order', 'orders');
  }
  
  // Custom methods here
}
```

### 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
import { logger } from '@/lib/logging/logger';

// Info
logger.info('Operation completed', 'module/function', { data });

// Error
logger.error('Operation failed', 'module/function', error instanceof Error ? { error: error.message, stack: error.stack } : { error: String(error) });

// Debug
logger.debug('Debug info', 'module/function', { data });

// Warn
logger.warn('Warning message', 'module/function', { data });
```

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
   - `docs/C4_ARCHITECTURE.md` - C4 –º–æ–¥–µ–ª—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
   - `docs/ARCHITECTURE.md` - –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

2. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥:**
   - `docs/REFACTORING_SUMMARY.md` - –ò—Ç–æ–≥–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

3. **Workflow:**
   - `docs/GIT_SYNC_WORKFLOW.md` - Git —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏ hot reload
   - `docs/DEVELOPMENT_WORKFLOW.md` - –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

4. **Onboarding:**
   - `NEW_CHAT_ONBOARDING.md` - –≠—Ç–æ—Ç —Ñ–∞–π–ª

---

## üö® –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **Prisma Client:**
   - ‚úÖ –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–π `prisma` –∏–∑ `lib/prisma.ts`
   - ‚ùå –ù–ò–ö–û–ì–î–ê –Ω–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ `new PrismaClient()` –≤ –∫–æ–¥–µ
   - ‚ùå –ù–ò–ö–û–ì–î–ê –Ω–µ –≤—ã–∑—ã–≤–∞–π—Ç–µ `prisma.$disconnect()` –≤ API routes

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `logger` –∏–∑ `lib/logging/logger.ts`
   - ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `console.log`/`console.error` –≤ production –∫–æ–¥–µ

3. **API Responses:**
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `apiSuccess`/`apiError` –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
   - ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `NextResponse.json` –Ω–∞–ø—Ä—è–º—É—é (–∫—Ä–æ–º–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)

4. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
   - ‚úÖ –í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ routes –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `requireAuth`/`requireAuthAndPermission`
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `withErrorHandling` HOC –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

5. **–¢–∏–ø–∏–∑–∞—Ü–∏—è:**
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `any` —Ç–∏–ø—ã

### üìù –°—Ç–∏–ª—å –∫–æ–¥–∞

- **TypeScript**: –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –±–µ–∑ `any`
- **–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ**: camelCase –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, PascalCase –¥–ª—è –∫–ª–∞—Å—Å–æ–≤
- **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Prettier (–Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ)
- **–õ–∏–Ω—Ç–∏–Ω–≥**: ESLint (–Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ)

---

## üîó –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò

- **Staging**: http://130.193.40.35:3001
- **Health Check**: http://130.193.40.35:3001/api/health
- **GitHub**: https://github.com/domeo3dmodeler-art/domeo2510
- **–í–µ—Ç–∫–∞**: `develop`

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –ü–û–î–î–ï–†–ñ–ö–ê

- **SSH –Ω–∞ staging**: `ssh ubuntu@130.193.40.35`
- **–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –í–ú**: `/opt/domeo`
- **Docker Compose —Ñ–∞–π–ª**: `docker-compose.staging-dev.yml`

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-01-06  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 2.0
