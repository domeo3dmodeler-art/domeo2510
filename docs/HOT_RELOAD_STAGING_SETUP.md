# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Hot Reload –Ω–∞ Staging —á–µ—Ä–µ–∑ Docker Volumes

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥:

1. **–ú–æ–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ–¥ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
2. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç dev —Ä–µ–∂–∏–º Next.js** - hot reload —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∫–æ–¥ –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–æ–π –∏ staging –í–ú** - —á–µ—Ä–µ–∑ rsync/scp

---

## ‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:

- ‚ö° **–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** - –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞
- üîÑ **Hot Reload** - Next.js –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
- üêõ **–ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ª–∞–¥–∫–∞** - –≤–∏–¥–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–∞–∑—É
- üìä **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ staging –ë–î

---

## üìã –ü–û–®–ê–ì–û–í–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê:

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ staging –í–ú

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ staging –í–ú (130.193.40.35):**

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ staging –í–ú
ssh ubuntu@130.193.40.35

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/domeo-staging

# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ docker-compose.staging-dev.yml —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω
# (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã)
```

### –®–∞–≥ 2: –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –Ω–∞ staging –í–ú

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
docker compose -f docker-compose.staging.yml down

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å hot reload
docker compose -f docker-compose.staging-dev.yml up -d

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose -f docker-compose.staging-dev.yml logs -f staging-app
```

### –®–∞–≥ 3: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (Windows):**

```powershell
# –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
.\scripts\sync-to-staging.ps1

# –ò–ª–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
.\scripts\sync-to-staging.ps1 -Force

# –ò–ª–∏ —Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö)
.\scripts\sync-to-staging.ps1 -Watch
```

**–ù–∞ Linux/Mac:**

```bash
# –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
./scripts/sync-to-staging.sh

# –° –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
./scripts/sync-to-staging.sh --force

# –†–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è (—Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ entr)
find . -type f | entr -r ./scripts/sync-to-staging.sh
```

---

## üîÑ WORKFLOW –†–ê–ó–†–ê–ë–û–¢–ö–ò:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```powershell
# 1. –ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ
# 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ —Å staging
.\scripts\sync-to-staging.ps1

# 3. –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (hot reload)
# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://130.193.40.35:3001
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª)
.\scripts\sync-to-staging.ps1 -Watch

# –¢–µ–ø–µ—Ä—å –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è
# –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –Ω–∞ staging
```

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í:

```
docker-compose.staging-dev.yml    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è hot reload
scripts/sync-to-staging.ps1       # –°–∫—Ä–∏–ø—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (Windows)
scripts/sync-to-staging.sh        # –°–∫—Ä–∏–ø—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (Linux/Mac)
```

---

## üîß –ß–¢–û –°–ò–ù–•–†–û–ù–ò–ó–ò–†–£–ï–¢–°–Ø:

‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è:**
- `app/` - –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ API routes
- `components/` - React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `lib/` - —É—Ç–∏–ª–∏—Ç—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- `public/` - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
- `prisma/` - —Å—Ö–µ–º–∞ –ë–î
- `package.json`, `tsconfig.json`, `next.config.ts` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

‚ùå **–ù–ï —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è:**
- `node_modules/` - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- `.next/` - –∫—ç—à Next.js (—Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)
- `.env.local` - –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `.git/` - git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø:

1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫** - –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
2. **Prisma Client** - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
3. **node_modules** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç volume, –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è
4. **–ë–î –º–∏–≥—Ä–∞—Ü–∏–∏** - –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ –≤—Ä—É—á–Ω—É—é –µ—Å–ª–∏ –∏–∑–º–µ–Ω—è–µ—Ç–µ schema

---

## üêõ –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú:

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ù–∞ staging –í–ú - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose -f docker-compose.staging-dev.yml logs -f staging-app

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose -f docker-compose.staging-dev.yml restart staging-app
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```powershell
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh ubuntu@130.193.40.35 "echo 'OK'"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã
ssh ubuntu@130.193.40.35 "ls -la /opt/domeo-staging"
```

### –ü—Ä–æ–±–ª–µ–º–∞: Prisma Client –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ù–∞ staging –í–ú - –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ Prisma Client
docker compose -f docker-compose.staging-dev.yml exec staging-app npx prisma generate
```

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –ü–û–î–•–û–î–û–í:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –°—Ç–∞—Ä—ã–π (build) | –ù–æ–≤—ã–π (hot reload) |
|----------|----------------|-------------------|
| –í—Ä–µ–º—è –¥–µ–ø–ª–æ—è | 5-15 –º–∏–Ω—É—Ç | ~30 —Å–µ–∫—É–Ω–¥ |
| –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ | –î–∞ | –ù–µ—Ç |
| Hot reload | –ù–µ—Ç | –î–∞ |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | Production-like | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ |

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:

1. **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose.staging-dev.yml`
2. **–î–ª—è production-like —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose.staging.yml`
3. **–î–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π** - —Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è (`-Watch`)
4. **–î–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ build —Ä–µ–∂–∏–º

---

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å hot reload –Ω–∞ staging!** üöÄ

