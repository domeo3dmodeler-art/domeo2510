# üöÄ Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –°–ï–ô–ß–ê–°:

### 1. –í–ú (staging) - ‚úÖ Healthy
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
- Health check –ø—Ä–æ—Ö–æ–¥–∏—Ç

### 2. Git - ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω
- –ö–æ–¥ –≤ `develop` –≤–µ—Ç–∫–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìã RECOMMENDED WORKFLOW:

### –ü–æ–¥—Ö–æ–¥ 1: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)

```bash
# 1. –ü—Ä–∞–≤–∏–º –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ
code app/api/auth/route.ts

# 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
npm run build

# 3. –ö–æ–º–º–∏—Ç–∏–º –∏ –ø—É—à–∏–º
git add .
git commit -m "Fix: –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã"
git push origin develop

# 4. –ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è –Ω–∞ –í–ú

# 5. –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ staging
curl http://130.193.40.35:3001/api/health
```

### –ü–æ–¥—Ö–æ–¥ 2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ SSH –Ω–∞ –í–ú (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)

```bash
# 1. –ó–∞—Ö–æ–¥–∏–º –Ω–∞ –í–ú
ssh ubuntu@130.193.40.35

# 2. –ó–∞—Ö–æ–¥–∏–º –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker exec -it domeo-staging-app sh

# 3. –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
docker logs domeo-staging-app -f

# 4. –ü—Ä–∞–≤–∏–º –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ, –ø—É—à–∏–º
git push origin develop

# 5. –ù–∞ –í–ú
cd /opt/domeo
git pull
docker compose -f docker-compose.staging.yml up -d --build
```

---

## üîß –¢–ï–ö–£–©–ò–ï –ó–ê–î–ê–ß–ò:

### ‚úÖ –°–¥–µ–ª–∞–Ω–æ:
1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω health check (–¥–æ–±–∞–≤–∏–ª–∏ curl –≤ Dockerfile)
2. –í–ú —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ healthy
3. –ö–æ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Git

### ‚è≥ –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞** - –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å VPN –∏–ª–∏ –ø—Ä–æ–∫—Å–∏
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker Compose –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   - –ò–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –í–ú

2. **–°—Ö–µ–º–∞ –ë–î** - –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –Ω–∞ –í–ú:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–∞ –í–ú –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
   - –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è**:
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GitHub Actions –¥–ª—è –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è
   - –ò–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ä—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ SSH

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ü–æ–¥—Ö–æ–¥ 1** (–±–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞):

- ‚úÖ –ë—ã—Å—Ç—Ä–æ
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- ‚úÖ –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å —Å–µ—Ç—å—é

**–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Compose (docker-compose.dev.yml)
- –ò–ª–∏ —Ä–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ –í–ú

---

## üìù –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

```bash
# 1. –ü—Ä–∞–≤–∏–º —Ñ–∞–π–ª
code app/api/users/route.ts

# 2. –ö–æ–º–º–∏—Ç–∏–º
git add app/api/users/route.ts
git commit -m "Fix: –∏—Å–ø—Ä–∞–≤–∏–ª –ª–æ–≥–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
git push origin develop

# 3. –û–±–Ω–æ–≤–ª—è–µ–º –í–ú
ssh ubuntu@130.193.40.35 "cd /opt/domeo && git pull && docker compose -f docker-compose.staging.yml up -d --build"

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º
curl http://130.193.40.35:3001/api/users
```

**–ì–æ—Ç–æ–≤–æ!** üéâ

