# üìã –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ Domeo

## üîç –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏** (`lib/logging/logger.ts`) - –¥–ª—è API routes –∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞
2. **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ª–æ–≥–∏** (`lib/logging/client-logger.ts`) - –¥–ª—è React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (`'use client'`)

---

## üñ•Ô∏è –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏ (API Routes)

### –í Development —Ä–µ–∂–∏–º–µ:

**–ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å:** –¢–µ—Ä–º–∏–Ω–∞–ª, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω dev —Å–µ—Ä–≤–µ—Ä (`npm run dev`)

**–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:**
```
[ERROR] [invoices/GET] [user:123] [session:abc12345...] Error fetching invoices
{
  "error": "..."
}
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
# –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ dev —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
npm run dev

# –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–æ—è–≤–∏—Ç—Å—è:
[INFO] [invoices/GET] [user:user-123] [session:session-abc...] –ù–∞–π–¥–µ–Ω–æ 5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
[ERROR] [orders/POST] [user:user-123] [session:session-xyz...] –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–∞:**
- `[LEVEL]` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (ERROR, WARN, INFO, DEBUG)
- `[context]` - –∫–æ–Ω—Ç–µ–∫—Å—Ç (–Ω–∞–∑–≤–∞–Ω–∏–µ API route, –Ω–∞–ø—Ä–∏–º–µ—Ä `invoices/GET`)
- `[user:ID]` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
- `[session:ID]` - ID —Å–µ—Å—Å–∏–∏ (–ø–µ—Ä–≤—ã–µ 8 —Å–∏–º–≤–æ–ª–æ–≤)
- –°–æ–æ–±—â–µ–Ω–∏–µ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (JSON)

### –í Production —Ä–µ–∂–∏–º–µ:

**–ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å:** Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ª–æ–≥–∏

```bash
# –î–ª—è staging:
docker compose -f docker-compose.staging.yml logs -f staging-app

# –î–ª—è production (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω winston):
# –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª—ã:
# - ./logs/app.log (–≤—Å–µ –ª–æ–≥–∏)
# - ./logs/error.log (—Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏)
# - ./logs/access.log (HTTP –∑–∞–ø—Ä–æ—Å—ã)
```

**–í Docker:**
```bash
# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
docker compose logs -f staging-app

# –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏:
docker compose logs staging-app | grep ERROR

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫:
docker compose logs --tail=100 staging-app
```

---

## üåê –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ª–æ–≥–∏ (React Components)

### –í Development —Ä–µ–∂–∏–º–µ:

**–ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å:** –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (DevTools)

**–ö–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å:**
- Chrome/Edge: `F12` –∏–ª–∏ `Ctrl+Shift+I` ‚Üí –≤–∫–ª–∞–¥–∫–∞ **Console**
- Firefox: `F12` ‚Üí –≤–∫–ª–∞–¥–∫–∞ **–ö–æ–Ω—Å–æ–ª—å**
- Safari: `Cmd+Option+I` ‚Üí –≤–∫–ª–∞–¥–∫–∞ **Console**

**–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:**
```
[DEBUG] –ü–æ–ª—É—á–∞–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã { orderId: "123", quoteId: null }
[INFO] –ù–∞–π–¥–µ–Ω–æ 5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ { count: 5 }
[ERROR] –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ { error: "..." }
[API] POST /api/auth/login - 200 { success: true }
```

**–í–∞–∂–Ω–æ:** 
- –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ª–æ–≥–∏ —Ä–∞–±–æ—Ç–∞—é—Ç **–¢–û–õ–¨–ö–û** –≤ development —Ä–µ–∂–∏–º–µ
- –í production –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ª–æ–≥–∏ **–æ—Ç–∫–ª—é—á–µ–Ω—ã** (–∫—Ä–æ–º–µ –æ—à–∏–±–æ–∫)
- –õ–æ–≥–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è `localhost` –∏ `127.0.0.1`

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```typescript
// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:
import { clientLogger } from '@/lib/logging/client-logger';

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
clientLogger.debug('–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω', { userId: user.id });
clientLogger.info('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', { count: items.length });
clientLogger.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏', error);
clientLogger.apiCall('GET', '/api/orders');
```

---

## üîç –ö–∞–∫ –Ω–∞–π—Ç–∏ –ª–æ–≥–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–ª–∏ —Å–µ—Å—Å–∏–∏

### –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏:

```bash
# –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ userId:
docker compose logs staging-app | grep "user:user-123"

# –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ sessionId:
docker compose logs staging-app | grep "session:abc12345"

# –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (API route):
docker compose logs staging-app | grep "invoices/GET"
```

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ª–æ–≥–∏:

–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã:
- `[DEBUG]` - —Ç–æ–ª—å–∫–æ debug –ª–æ–≥–∏
- `[ERROR]` - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
- `[API]` - —Ç–æ–ª—å–∫–æ API –∑–∞–ø—Ä–æ—Å—ã

---

## üìä –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏:

- **ERROR** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (–≤—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è)
- **WARN** - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **INFO** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **DEBUG** - –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ª–æ–≥–∏:

- **ERROR** - –û—à–∏–±–∫–∏ (–ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤—Å–µ–≥–¥–∞, –¥–∞–∂–µ –≤ production)
- **WARN** - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **INFO** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **DEBUG** - –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ development)

---

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏:

–í `lib/logging/logger.ts` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å:

```typescript
// –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: INFO (–ª–æ–≥–∏—Ä—É—é—Ç—Å—è ERROR, WARN, INFO)
logger.setLevel(LogLevel.DEBUG); // –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤–∫–ª—é—á–∞—è DEBUG
```

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ª–æ–≥–∏:

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ `window.location.hostname`:
- `localhost` –∏–ª–∏ `127.0.0.1` ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ
- –î—Ä—É–≥–∏–µ –¥–æ–º–µ–Ω—ã ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ (–∫—Ä–æ–º–µ ERROR)

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í API Route:

```typescript
import { logger } from '@/lib/logging/logger';
import { getLoggingContextFromRequest } from '@/lib/auth/logging-context';

export async function GET(req: NextRequest) {
  const loggingContext = getLoggingContextFromRequest(req);
  
  try {
    logger.info('–ó–∞–ø—Ä–æ—Å –Ω–∞—á–∞—Ç', 'orders/GET', {}, loggingContext);
    // ... –∫–æ–¥ ...
    logger.debug('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'orders/GET', { count: orders.length }, loggingContext);
  } catch (error) {
    logger.error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞', 'orders/GET', { error }, loggingContext);
  }
}
```

### –í React Component:

```typescript
'use client';

import { clientLogger } from '@/lib/logging/client-logger';

export default function MyComponent() {
  useEffect(() => {
    clientLogger.debug('–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω', { component: 'MyComponent' });
    
    fetch('/api/data')
      .then(res => {
        clientLogger.apiResponse('GET', '/api/data', res.status);
        return res.json();
      })
      .catch(error => {
        clientLogger.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', error);
      });
  }, []);
}
```

---

## üö® Troubleshooting

### –õ–æ–≥–∏ –Ω–µ –≤–∏–¥–Ω—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `NODE_ENV=development`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—É—â–µ–Ω `npm run dev`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `logger.setLevel(LogLevel.DEBUG)`

### –õ–æ–≥–∏ –Ω–µ –≤–∏–¥–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –Ω–∞ `localhost` –∏–ª–∏ `127.0.0.1`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤ –∫–æ–Ω—Å–æ–ª–∏ (–Ω–µ —Å–∫—Ä—ã—Ç—ã –ª–∏ –ª–æ–≥–∏)
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É

### –õ–æ–≥–∏ –≤ Docker:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
docker compose ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:
docker compose logs staging-app

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
docker compose logs -f staging-app

# –õ–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å:
docker compose logs --since 1h staging-app
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **–°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏**: `lib/logging/logger.ts`
- **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ª–æ–≥–∏**: `lib/logging/client-logger.ts`
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**: `lib/auth/logging-context.ts`

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-XX

