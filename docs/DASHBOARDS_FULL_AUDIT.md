# üîç –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –ª–æ–≥–∏–∫–∏ –ª–∏—á–Ω—ã—Ö –∫–∞–±–∏–Ω–µ—Ç–æ–≤

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2025-11-11  
**–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã:** develop  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-11 (—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã-—Ä–æ–ª–µ–π)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—á–Ω—ã—Ö –∫–∞–±–∏–Ω–µ—Ç–æ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ª–∏—á–Ω—ã—Ö-–∫–∞–±–∏–Ω–µ—Ç–æ–≤)
3. [–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ –∑–∞—â–∏—Ç–∞ –¥–æ—Å—Ç—É–ø–∞](#–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è-–∏-–∑–∞—â–∏—Ç–∞-–¥–æ—Å—Ç—É–ø–∞)
4. [API Endpoints](#api-endpoints)
5. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞—â–∏—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-–∑–∞—â–∏—Ç—ã)
6. [–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è](#–ø—Ä–∞–≤–∞-–¥–æ—Å—Ç—É–ø–∞-–∏-—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)
7. [–ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#–Ω–∞–π–¥–µ–Ω–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
8. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-—É–ª—É—á—à–µ–Ω–∏—é)

---

## üë• –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π

### –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. **ADMIN** (`admin`) - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
   - –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —Å–∏—Å—Ç–µ–º—ã
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–∞—Ç–∞–ª–æ–≥–æ–º, –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
   - –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
   - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

2. **COMPLECTATOR** (`complectator`) - –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä
   - –†–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏
   - –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ö–ü, —Å—á–µ—Ç–æ–≤, –∑–∞–∫–∞–∑–æ–≤
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏ –¥–æ —Å—Ç–∞—Ç—É—Å–∞ `NEW_PLANNED`
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞/–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏

3. **EXECUTOR** (`executor`) - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
   - –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –∏ —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–±—Ä–∏–∫–æ–π
   - –†–∞–±–æ—Ç–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ (SupplierOrder)
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤ –æ—Ç `NEW_PLANNED` –¥–æ `COMPLETED`
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∏ –æ–ø—Ç–æ–≤—ã—Ö —Å—á–µ—Ç–æ–≤

4. **MANAGER** (`manager`) - –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å
   - –ö–æ–Ω—Ç—Ä–æ–ª—å –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ (–Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã)

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π

**–§–∞–π–ª:** `lib/auth/roles.ts`

```typescript
export enum UserRole {
  ADMIN = 'admin',
  COMPLECTATOR = 'complectator',
  EXECUTOR = 'executor',
  MANAGER = 'manager'
}
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—á–Ω—ã—Ö –∫–∞–±–∏–Ω–µ—Ç–æ–≤

### 1. –õ–ö –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (`/admin/*`)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/admin` ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/dashboard`
- `/admin/users` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `/admin/categories` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- `/admin/catalog` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º
- `/admin/import` - –ò–º–ø–æ—Ä—Ç –ø—Ä–∞–π—Å–æ–≤
- `/admin/analytics` - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- `/admin/settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- `/admin/products` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
- `/admin/clients` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- `/admin/configurator` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä
- `/admin/doors` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–µ—Ä—è–º–∏

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `app/admin/page.tsx` - –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ dashboard
- `app/admin/**/page.tsx` - –°—Ç—Ä–∞–Ω–∏—Ü—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- `components/layout/AdminLayout.tsx` - Layout –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ middleware (—Ç–æ–ª—å–∫–æ `admin` —Ä–æ–ª—å)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `AdminLayout` –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- ‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ `app/admin/catalog/page.tsx`

### 2. –õ–ö –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞ (`/complectator/dashboard`)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/complectator/dashboard` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –õ–ö

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `app/complectator/dashboard/page.tsx` - –û–±–µ—Ä—Ç–∫–∞ —Å `ClientAuthGuard`
- `app/complectator/dashboard/ComplectatorDashboardComponent.tsx` - –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ–∏—Å–∫)
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –ö–ü (–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å–æ —Å—á–µ—Ç–∞–º–∏ (Invoices)
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏ (Orders)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞/–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ (—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤ (DRAFT ‚Üí SENT ‚Üí NEW_PLANNED ‚Üí RETURNED_TO_COMPLECTATION)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞: `ClientAuthGuard` + –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `fetchWithAuth` –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ: –µ—Å–ª–∏ —Ä–æ–ª—å –Ω–µ `complectator`, —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/dashboard`

### 3. –õ–ö –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (`/executor/dashboard`)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/executor/dashboard` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –õ–ö

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `app/executor/dashboard/page.tsx` - –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- `components/executor/OrdersBoard.tsx` - –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä)
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å–æ —Å—á–µ—Ç–∞–º–∏ (Invoices) - –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ (SupplierOrders) - —Å–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –¢–∞–±–ª–æ –∑–∞–∫–∞–∑–æ–≤ (Orders Board) - –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∏ –æ–ø—Ç–æ–≤—ã—Ö —Å—á–µ—Ç–æ–≤
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤ (NEW_PLANNED ‚Üí UNDER_REVIEW ‚Üí ... ‚Üí COMPLETED)
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –∑–∞–∫–∞–∑–æ–≤ –≤ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—é (RETURNED_TO_COMPLECTATION)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `useAuth` hook –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π UI —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º —Å –∏–∫–æ–Ω–∫–∞–º–∏ –∏ —Å—á–µ—Ç—á–∏–∫–∞–º–∏

### 4. –õ–ö –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è (`/manager/dashboard`)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/manager/dashboard` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –õ–ö

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `app/manager/dashboard/page.tsx` - –û–±–µ—Ä—Ç–∫–∞
- `app/manager/dashboard/ManagerDashboardComponent.tsx` - –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
- ‚ùå –ù–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ (read-only –¥–æ—Å—Ç—É–ø)

### 5. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π Dashboard (`/dashboard`)

**–§–∞–π–ª:** `app/dashboard/page.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –†–æ—É—Ç–∏–Ω–≥ –ø–æ —Ä–æ–ª—è–º:
  - `admin` ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–¥–º–∏–Ω-–¥–∞—à–±–æ—Ä–¥ —Å –≤–∏–¥–∂–µ—Ç–∞–º–∏
  - `complectator` ‚Üí —Ä–µ–Ω–¥–µ—Ä–∏—Ç `ComplectatorDashboard`
  - `executor` ‚Üí —Ä–µ–Ω–¥–µ—Ä–∏—Ç `ExecutorDashboard`
  - `manager` ‚Üí —Ä–µ–Ω–¥–µ—Ä–∏—Ç `ManagerDashboard`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ClientAuthGuard` –¥–ª—è –∑–∞—â–∏—Ç—ã
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
- ‚úÖ –î–ª—è –∞–¥–º–∏–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∏–¥–∂–µ—Ç—ã –∏ –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

---

## üõ°Ô∏è –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ –∑–∞—â–∏—Ç–∞ –¥–æ—Å—Ç—É–ø–∞

### Middleware (`middleware.ts`)

**–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –ø—É—Ç–∏:**
```typescript
const protectedPaths = ['/admin', '/complectator', '/executor', '/universal'];
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞:**

1. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (`/admin/*`):**
   ```typescript
   if (pathname.startsWith('/admin')) {
     if (userRole !== 'admin') {
       return NextResponse.redirect(new URL('/auth/unauthorized', request.url));
     }
   }
   ```
   ‚úÖ **–°—Ç–∞—Ç—É—Å:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ - —Ç–æ–ª—å–∫–æ `admin` –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø

2. **–ê–¥–º–∏–Ω-—Ç–æ–ª—å–∫–æ –ø—É—Ç–∏:**
   ```typescript
   const adminOnlyPaths = [
     '/admin/users',
     '/admin/settings',
     '/admin/analytics',
     '/admin/notifications-demo',
     '/admin/categories/builder',
     '/admin/catalog/import'
   ];
   ```
   ‚úÖ **–°—Ç–∞—Ç—É—Å:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤

3. **–ü—É—Ç–∏ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–æ–≤:**
   ```typescript
   const complectatorPaths: string[] = [
     // –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä—ã –Ω–µ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
   ];
   ```
   ‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–∞—Å—Å–∏–≤ –ø—É—Å—Ç–æ–π, –Ω–æ `/complectator/*` –∑–∞—â–∏—â–µ–Ω —á–µ—Ä–µ–∑ `protectedPaths`
   ‚úÖ **–°—Ç–∞—Ç—É—Å:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —è–≤–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É

4. **–ü—É—Ç–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π:**
   ```typescript
   const executorPaths: string[] = [
     // –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –Ω–µ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
   ];
   ```
   ‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ complectatorPaths
   ‚úÖ **–°—Ç–∞—Ç—É—Å:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

5. **–≠–∫—Å–ø–æ—Ä—Ç –Ω–∞ —Ñ–∞–±—Ä–∏–∫—É:**
   ```typescript
   const factoryExportPaths = [
     '/api/cart/export/doors/factory'
   ];
   ```
   ‚úÖ **–°—Ç–∞—Ç—É—Å:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ - –¥–æ—Å—Ç—É–ø –¥–ª—è `admin` –∏ `executor`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç–æ–∫–µ–Ω–∞:**
1. Cookie: `auth-token` –∏–ª–∏ `domeo-auth-token`
2. –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ (–∏–∑ cookie)

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `JWT_SECRET`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã `JWT_SECRET` (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
- ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ `jwtVerify` –∏–∑ `jose`
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–æ–ª–∏ –∏–∑ payload: `payload.role?.toString().toLowerCase()`

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏:**
```typescript
requestHeaders.set('x-user-id', payload.userId?.toString() || '');
requestHeaders.set('x-user-role', userRole);
```

---

## üîå API Endpoints

### –ê–¥–º–∏–Ω—Å–∫–∏–µ API (`/api/admin/*`)

**–ü—Ä–∏–º–µ—Ä—ã:**
- `/api/admin/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–¥–º–∏–Ω–∞
- `/api/admin/templates` - –®–∞–±–ª–æ–Ω—ã –∏–º–ø–æ—Ä—Ç–∞
- `/api/admin/export/price-list` - –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞
- `/api/admin/products/*` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
- `/api/admin/categories/*` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- `/api/admin/import/*` - –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç `requireAuthAndPermission(handler, 'admin')`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ —á–µ—Ä–µ–∑ `checkRole` (case-insensitive)
- ‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `app/admin/catalog/page.tsx`)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–µ–ª–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ –∞–¥–º–∏–Ω API –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ `app/admin/catalog/page.tsx`

### API –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞ (`/api/complectator/*`)

**Endpoints:**
- `/api/complectator/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `requireAuth` (–ª—é–±–æ–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- ‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ - –ª—é–±–æ–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```typescript
export const GET = withErrorHandling(
  requireAuthAndPermission(getHandler, 'complectator'),
  'complectator/stats/GET'
);
```

### API –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (`/api/executor/*`)

**Endpoints:**
- ‚ùå **–ù–µ –Ω–∞–π–¥–µ–Ω–æ** - –Ω–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö API endpoints –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `/api/executor/stats` –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ API endpoints (`/api/orders/*`, `/api/supplier-orders/*`)

### –û–±—â–∏–µ API (`/api/*`)

**–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints:**
- `/api/orders/*` - –ó–∞–∫–∞–∑—ã
- `/api/invoices/*` - –°—á–µ—Ç–∞
- `/api/quotes/*` - –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- `/api/supplier-orders/*` - –ó–∞–∫–∞–∑—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
- `/api/clients/*` - –ö–ª–∏–µ–Ω—Ç—ã
- `/api/documents/*` - –î–æ–∫—É–º–µ–Ω—Ç—ã
- `/api/users/*` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç `requireAuth` –∏–ª–∏ `requireAuthAndPermission`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ —á–µ—Ä–µ–∑ `canUserPerformAction`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ —Å—Ç–∞—Ç—É—Å–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## üîí –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞—â–∏—Ç—ã

### ClientAuthGuard (`components/auth/ClientAuthGuard.tsx`)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ `localStorage` (`authToken`)
- ‚úÖ Fallback –Ω–∞ cookie (`auth-token` –∏–ª–∏ `domeo-auth-token`)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –µ—Å–ª–∏ –Ω–µ—Ç –≤ `localStorage`
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ `localStorage`
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login` –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ–∫–µ–Ω–∞

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è —Ç–æ–∫–µ–Ω–∞: `authToken` –≤ localStorage, –Ω–æ `token` –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `authToken` –≤–µ–∑–¥–µ
- –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π hook `useAuth` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

**ComplectatorDashboard:**
```typescript
if (data.user.role !== 'complectator') {
  router.push('/dashboard');
  return;
}
```
‚úÖ **–°—Ç–∞—Ç—É—Å:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**ExecutorDashboard:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `useAuth` hook
- ‚úÖ **–°—Ç–∞—Ç—É—Å:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**AdminCatalogPage:**
```typescript
useEffect(() => {
  const checkAdminAccess = async () => {
    const response = await fetchWithAuth('/api/users/me');
    const data = await response.json();
    const userRole = responseData?.user?.role;
    if (userRole !== 'admin') {
      router.push('/auth/unauthorized');
      return;
    }
    setHasAccess(true);
  };
  checkAdminAccess();
}, [router]);
```
‚úÖ **–°—Ç–∞—Ç—É—Å:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

---

## üîê –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### –°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (`lib/auth/permissions.ts`)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
1. `canUserPerformAction(userRole, action, documentType?, documentStatus?, documentCreatorId?, userId?)`
2. `canUserCreateDocument(userRole, documentType)`
3. `canUserEditClient(userRole)`
4. `canUserDeleteClient(userRole)`
5. `canUserChangeStatus(userRole, documentType, currentStatus?, newStatus?)`

### –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ —Ä–æ–ª—è–º (`lib/auth/roles.ts`)

**ADMIN:**
- ‚úÖ –í—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø)

**COMPLECTATOR:**
- ‚úÖ `clients.create`, `clients.read`, `clients.update`
- ‚úÖ `quotes.create`, `quotes.read`, `quotes.update`, `quotes.export`
- ‚úÖ `orders.create`, `orders.read`, `orders.update`
- ‚úÖ `invoices.create`, `invoices.read`, `invoices.export`
- ‚ùå `clients.delete` - –Ω–µ –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤
- ‚ùå `orders.delete` - –Ω–µ –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –∑–∞–∫–∞–∑—ã (—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –≤ —Å—Ç–∞—Ç—É—Å–µ DRAFT/CANCELLED)

**EXECUTOR:**
- ‚úÖ `clients.read` - —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ
- ‚úÖ `quotes.read`, `orders.read`, `invoices.read` - —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ
- ‚úÖ `supplier_orders.create`, `supplier_orders.read`, `supplier_orders.update`
- ‚ùå –ù–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤, –ö–ü, —Å—á–µ—Ç–∞, –∑–∞–∫–∞–∑—ã

**MANAGER:**
- ‚úÖ –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ `analytics.read`
- ‚ùå –ù–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã

### –õ–æ–≥–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

**Order —Å—Ç–∞—Ç—É—Å—ã:**

**Complectator –º–æ–∂–µ—Ç:**
- DRAFT ‚Üí SENT, CANCELLED
- SENT ‚Üí NEW_PLANNED, CANCELLED
- NEW_PLANNED ‚Üí CANCELLED, RETURNED_TO_COMPLECTATION
- RETURNED_TO_COMPLECTATION ‚Üí DRAFT, SENT, NEW_PLANNED
- ‚ùå –ù–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (UNDER_REVIEW, AWAITING_MEASUREMENT, etc.)

**Executor –º–æ–∂–µ—Ç:**
- NEW_PLANNED ‚Üí UNDER_REVIEW ‚Üí AWAITING_MEASUREMENT ‚Üí AWAITING_INVOICE ‚Üí READY_FOR_PRODUCTION ‚Üí COMPLETED
- –õ—é–±–æ–π —Å—Ç–∞—Ç—É—Å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è ‚Üí RETURNED_TO_COMPLECTATION
- ‚ùå –ù–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞ (DRAFT, SENT)

**Admin –º–æ–∂–µ—Ç:**
- ‚úÖ –í—Å–µ —Å—Ç–∞—Ç—É—Å—ã

**Manager:**
- ‚ùå –ù–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã

---

## ‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ –≤ `/api/complectator/stats`**
   - **–§–∞–π–ª:** `app/api/complectator/stats/route.ts`
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ `requireAuth`, –ª—é–±–æ–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `requireAuthAndPermission(handler, 'complectator')`

2. **‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ API endpoints –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è**
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç `/api/executor/stats` –∏–ª–∏ –¥—Ä—É–≥–∏—Ö endpoints
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å endpoints –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

### –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

3. **‚ö†Ô∏è –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π —Ç–æ–∫–µ–Ω–∞**
   - **–ü—Ä–æ–±–ª–µ–º–∞:** 
     - `ClientAuthGuard` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `authToken` –≤ localStorage
     - `ComplectatorDashboard` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `token` –≤ localStorage
     - `DashboardContent` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `authToken`
   - **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ `authToken` –≤–µ–∑–¥–µ

4. **‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–≤–æ—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–æ–∫–µ–Ω–∞
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—ã–π `useAuth` hook

5. **‚ö†Ô∏è –ü—É—Å—Ç—ã–µ –º–∞—Å—Å–∏–≤—ã –≤ middleware**
   - **–ü—Ä–æ–±–ª–µ–º–∞:** `complectatorPaths` –∏ `executorPaths` –ø—É—Å—Ç—ã–µ
   - **–°—Ç–∞—Ç—É—Å:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–µ—Ä–µ–∑ `protectedPaths`, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

### –ù–∏–∑–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

6. **‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö**
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª–∞–≥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ middleware
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

7. **‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π hook:**
```typescript
// hooks/useAuth.ts
export function useAuth() {
  const [user, setUser] = useState<User | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  
  useEffect(() => {
    // –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞
    const token = localStorage.getItem('authToken') || getTokenFromCookie();
    if (!token) {
      router.push('/login');
      return;
    }
    
    fetchWithAuth('/api/users/me')
      .then(res => res.json())
      .then(data => setUser(data.user))
      .finally(() => setIsLoading(false));
  }, []);
  
  return { user, isLoading };
}
```

### 2. –£–ª—É—á—à–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã API

**–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–∏ –≤ `/api/complectator/stats`:**
```typescript
export const GET = withErrorHandling(
  requireAuthAndPermission(getHandler, 'complectator'),
  'complectator/stats/GET'
);
```

**–°–æ–∑–¥–∞—Ç—å API –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:**
```typescript
// app/api/executor/stats/route.ts
export const GET = withErrorHandling(
  requireAuthAndPermission(getHandler, 'executor'),
  'executor/stats/GET'
);
```

### 3. –£–ª—É—á—à–µ–Ω–∏–µ middleware

**–î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–µ –ø—É—Ç–∏:**
```typescript
const complectatorPaths: string[] = [
  '/complectator/dashboard'
];

const executorPaths: string[] = [
  '/executor/dashboard'
];
```

### 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤:**
```typescript
logger.info('–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –∏–∑–º–µ–Ω–µ–Ω', 'orders/[id]/status', {
  orderId,
  oldStatus,
  newStatus,
  userId: user.userId,
  userRole: user.role
}, loggingContext);
```

### 5. –£–ª—É—á—à–µ–Ω–∏–µ UI/UX

**–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–ø–∏–Ω–Ω–µ—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

**–£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏

### 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã:**
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è `canUserPerformAction`
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è `canUserChangeStatus`
- Integration-—Ç–µ—Å—Ç—ã –¥–ª—è API endpoints
- E2E-—Ç–µ—Å—Ç—ã –¥–ª—è –ª–∏—á–Ω—ã—Ö –∫–∞–±–∏–Ω–µ—Ç–æ–≤

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞ (middleware + –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã + API)
- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –ø–æ —Ä–æ–ª—è–º
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ Case-insensitive —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π

**–°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚ö†Ô∏è –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–ª—é—á–µ–π —Ç–æ–∫–µ–Ω–∞
- ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö API endpoints
- ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

1. ‚úÖ **–í—ã—Å–æ–∫–∏–π:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–∏ –≤ `/api/complectator/stats` - **–í–´–ü–û–õ–ù–ï–ù–û**
2. ‚úÖ **–°—Ä–µ–¥–Ω–∏–π:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏ —Ç–æ–∫–µ–Ω–∞ - **–í–´–ü–û–õ–ù–ï–ù–û**
3. ‚úÖ **–°—Ä–µ–¥–Ω–∏–π:** –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π `useAuth` hook - **–í–´–ü–û–õ–ù–ï–ù–û**
4. ‚úÖ **–ù–∏–∑–∫–∏–π:** –î–æ–±–∞–≤–∏—Ç—å API endpoints –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è - **–í–´–ü–û–õ–ù–ï–ù–û**
5. ‚è≥ **–ù–∏–∑–∫–∏–π:** –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ - **–í –ü–†–û–¶–ï–°–°–ï**

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–õ–æ–≥–∏–∫–∞ –ª–∏—á–Ω—ã—Ö –∫–∞–±–∏–Ω–µ—Ç–æ–≤ –≤ —Ü–µ–ª–æ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –∑–∞—â–∏—Ç–æ–π –¥–æ—Å—Ç—É–ø–∞. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∞–Ω—ã —Å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å—é –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–ª—é—á–µ–π —Ç–æ–∫–µ–Ω–∞ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö API endpoints. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (2025-11-11)

### 1. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–ª—é—á–µ–π —Ç–æ–∫–µ–Ω–∞ (`token` vs `authToken`)

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–ª—É—á—à–µ–Ω `useAuth` hook –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç–æ–∫–µ–Ω–∞: `localStorage.getItem('authToken')`
- ‚úÖ Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π –∫–ª—é—á `token` —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–∏–≥—Ä–∞—Ü–∏–µ–π
- ‚úÖ Fallback –Ω–∞ cookies (`auth-token`, `domeo-auth-token`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ localStorage
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `fetchWithAuth` –¥–ª—è –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `parseApiResponse` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–æ–≤

**–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `hooks/useAuth.ts` - –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω
- `app/complectator/dashboard/page.tsx` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `authToken`
- `components/documents/DocumentQuickViewModal.tsx` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `authToken`

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ –≤ API

**–ü—Ä–æ–±–ª–µ–º–∞:** `/api/complectator/stats` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω `requireAuth` –Ω–∞ `requireAuthAndPermission(handler, 'complectator')`
- ‚úÖ –¢–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–æ–ª—å—é `complectator` –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø

**–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–π —Ñ–∞–π–ª:**
- `app/api/complectator/stats/route.ts`

### 3. –°–æ–∑–¥–∞–Ω–∏–µ API endpoint –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª API endpoint –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `/api/executor/stats` endpoint
- ‚úÖ –ó–∞—â–∏—â–µ–Ω —á–µ—Ä–µ–∑ `requireAuthAndPermission(handler, 'executor')`
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∑–∞–∫–∞–∑–∞–º, –∑–∞–∫–∞–∑–∞–º –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –∏ —Å—á–µ—Ç–∞–º
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:**
- `app/api/executor/stats/route.ts`

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API endpoints
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-11  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.1

