# üîç –ü–û–õ–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –õ–û–ì–ò–ö–ò –ò–ú–ü–û–†–¢–ê –¢–û–í–ê–†–û–í –ò –§–û–¢–û

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-10-31  
**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:**
- `app/api/admin/import/unified/route.ts` - –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤
- `app/api/admin/import/photos/route.ts` - –ò–º–ø–æ—Ä—Ç —Ñ–æ—Ç–æ

---

## ‚úÖ –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø–ú

### 1. ‚úÖ –ü—É—Å—Ç–æ–π SKU ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ü—Ä–∏ –ø—É—Å—Ç–æ–º SKU —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä, –≤—Å–µ –ø–æ–ª—è –∏–∑ —à–∞–±–ª–æ–Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∏ 217-255):**
```javascript
if (internalSku && internalSku.trim() !== '') {
  product.sku = internalSku.trim();
} else {
  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ SKU
  product.sku = `SKU_${timestamp}_${randomSuffix}_${i + 1}_${supplierSku}`;
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–æ 10 –ø–æ–ø—ã—Ç–æ–∫
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (—Å—Ç—Ä–æ–∫–∏ 271-283):**
```javascript
if (!internalSku || internalSku.trim() === '') {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –í–°–ï –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏–∑ —à–∞–±–ª–æ–Ω–∞
  missingRequiredFields = requiredFields.filter(field => {
    hasFieldInFile = fixedHeaders.includes(field);
    value = properties[field];
    return !hasFieldInFile || !value || value === '' || value === '-';
  });
}
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

---

### 2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ SKU –≤–æ –≤—Å–µ–π –ë–î

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** SKU –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤–æ –≤—Å–µ–π –ë–î —Ç–æ–≤–∞—Ä–æ–≤ (–Ω–µ —Ç–æ–ª—å–∫–æ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- **Preview —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∏ 316-321):** `prisma.product.findUnique({ where: { sku } })`
- **Import —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∏ 386-390):** `prisma.product.findUnique({ where: { sku } })`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

---

### 3. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ–π –∏–∑ —à–∞–±–ª–æ–Ω–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ü–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —à–∞–±–ª–æ–Ω–µ –∏–∑ —Ñ–∞–π–ª–∞ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∏–∫–∞–∫.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∏ 198-212):**
```javascript
// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ–ª—è –∏–∑ —à–∞–±–ª–æ–Ω–∞
requiredFields.forEach(field => {
  const headerIndex = fixedHeaders.indexOf(field);
  if (headerIndex !== -1 && row[headerIndex] !== undefined) {
    const value = row[headerIndex];
    if (value !== undefined && value !== null && value !== '' && value !== '-') {
      properties[field] = value;
    }
  }
  // –ï—Å–ª–∏ –ø–æ–ª–µ –∏–∑ —à–∞–±–ª–æ–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ñ–∞–π–ª–µ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
});
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

---

### 4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–º SKU

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ï—Å–ª–∏ SKU –≤ —Ñ–∞–π–ª–µ —É–∫–∞–∑–∞–Ω –∏ –æ–Ω –Ω–∞–π–¥–µ–Ω –≤ –ë–î, —Ç–æ –∏–∑ —Ñ–∞–π–ª–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑ –±–∞–∑—ã.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∏ 397-433):**
```javascript
if (existingProduct) {
  // –ü–æ–ª—É—á–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞
  existingProperties = JSON.parse(existingProduct.properties_data);
  newProperties = { ...existingProperties }; // –ö–æ–ø–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
  
  // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è –∏–∑ —Ñ–∞–π–ª–∞
  Object.keys(product.properties_data).forEach((originalKey, index) => {
    const fixedKey = fixedKeys[index];
    const value = product.properties_data[originalKey];
    if (value !== undefined && value !== null && value !== '' && value !== '-') {
      newProperties[fixedKey] = value; // –û–±–Ω–æ–≤–ª—è–µ–º
    }
  });
  
  updateData.properties_data = JSON.stringify(newProperties);
  await prisma.product.update(...);
}
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

---

### 5. ‚úÖ –ü—É—Å—Ç—ã–µ –ø–æ–ª—è –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç –ë–î

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ï—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–µ - –æ–Ω–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∏ 419-425):**
```javascript
if (value !== undefined && value !== null && value !== '' && value !== '-') {
  newProperties[fixedKey] = value; // –¢–æ–ª—å–∫–æ –ù–ï –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
}
// –ü—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ù–ï –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ newProperties ‚Üí –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

---

### 6. ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –µ—Å—Ç—å - –æ–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –°–º. –≤—ã—à–µ - —Ç–æ–ª—å–∫–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª—è—é—Ç `newProperties`.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

---

### 7. ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å SKU –≤–æ –≤—Å–µ–π –ë–î

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** SKU –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –≤–æ –≤—Å–µ–π –ë–î —Ç–æ–≤–∞—Ä–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- **–°—Ö–µ–º–∞ Prisma:** `sku String @unique` ‚úÖ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `prisma.product.findUnique({ where: { sku } })` ‚úÖ
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–ª–ª–∏–∑–∏–π:** try-catch —Å P2002 –æ—à–∏–±–∫–æ–π ‚úÖ
- **–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–æ 10 –ø–æ–ø—ã—Ç–æ–∫ ‚úÖ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

---

## ‚ö†Ô∏è –ö–û–ù–§–õ–ò–ö–¢–´ –ò –ü–†–û–ë–õ–ï–ú–´

### üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞ (—Å—Ç—Ä–æ–∫–∏ 392-395, 430-433):**
```javascript
// –¢–æ–≤–∞—Ä –Ω–∞–π–¥–µ–Ω –≤ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
if (existingProduct && existingProduct.catalog_category_id !== categoryId) {
  console.warn(`‚ö†Ô∏è SKU "${product.sku}" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏`);
}

// –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ù–ï –º–µ–Ω—è–µ—Ç—Å—è!
await prisma.product.update({
  where: { id: existingProduct.id },
  data: updateData // ‚Üê catalog_category_id –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
});
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –Ω–æ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ —Å—Ç–∞—Ä–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è, –Ω–æ –æ–Ω –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ: —Ç–æ–≤–∞—Ä –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A, –Ω–æ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ B

**–í–æ–ø—Ä–æ—Å:** –î–æ–ª–∂–Ω–∞ –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è, –µ—Å–ª–∏ SKU –Ω–∞–π–¥–µ–Ω –≤ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏?

**–†–µ—à–µ–Ω–∏–µ:**
- **–í–∞—Ä–∏–∞–Ω—Ç 1:** –ù–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é (—Ç–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞) - —Ç–æ–≤–∞—Ä –æ—Å—Ç–∞–µ—Ç—Å—è –≤ —Å—Ç–∞—Ä–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- **–í–∞—Ä–∏–∞–Ω—Ç 2:** –û–±–Ω–æ–≤–ª—è—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é - –ø–µ—Ä–µ–º–µ—â–∞—Ç—å —Ç–æ–≤–∞—Ä –≤ –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- **–í–∞—Ä–∏–∞–Ω—Ç 3:** –û—à–∏–±–∫–∞ - –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê 2: –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

**–ü—Ä–æ–±–ª–µ–º–∞ (—Å—Ç—Ä–æ–∫–∏ 274-279):**
```javascript
missingRequiredFields = requiredFields.filter(field => {
  hasFieldInFile = fixedHeaders.includes(field);
  value = properties[field];
  return !hasFieldInFile || !value || value === '' || value === '-';
});
```

**–ê–Ω–∞–ª–∏–∑:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –µ—Å—Ç—å –ª–∏ –ø–æ–ª–µ –≤ —Ñ–∞–π–ª–µ (`hasFieldInFile`)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ª–∏ –ø–æ–ª–µ (`value`)
- –ï—Å–ª–∏ –ø–æ–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ñ–∞–π–ª–µ –ò –ø—É—Å—Ç–æ–µ ‚Üí –æ—à–∏–±–∫–∞ ‚úÖ

**–ù–æ:** –ï—Å–ª–∏ –ø–æ–ª–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ñ–∞–π–ª–µ, —Ç–æ:
- `hasFieldInFile = false`
- `value = undefined`
- `missingRequiredFields` –≤–∫–ª—é—á–∞–µ—Ç —ç—Ç–æ –ø–æ–ª–µ ‚úÖ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–õ–û–ì–ò–ö–ê –ü–†–ê–í–ò–õ–¨–ù–ê–Ø**

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê 3: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SKU

**–ü—Ä–æ–±–ª–µ–º–∞ (—Å—Ç—Ä–æ–∫–∏ 235-250):**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ü–∏–∫–ª–µ –¥–ª—è –ö–ê–ñ–î–û–ô —Å—Ç—Ä–æ–∫–∏ —Å –ø—É—Å—Ç—ã–º SKU
while (attempts < 10) {
  const existing = await prisma.product.findUnique({
    where: { sku: product.sku }
  });
  // ...
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ —Å –ø—É—Å—Ç—ã–º SKU –¥–µ–ª–∞–µ—Ç—Å—è –¥–æ 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- –ü—Ä–∏ —Ñ–∞–π–ª–µ —Å 1000 —Å—Ç—Ä–æ–∫ –∏ 500 –ø—É—Å—Ç—ã–º–∏ SKU ‚Üí –¥–æ 5000 –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–µ–¥–ª–µ–Ω–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å batch –ø—Ä–æ–≤–µ—Ä–∫—É —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
- –ò–ª–∏ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ SKU
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é (UUID)

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** ‚ö†Ô∏è **–°–†–ï–î–ù–Ø–Ø** (–≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–æ–ª—å—à–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤)

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞

**–õ–æ–≥–∏–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 403-406):**
```javascript
// –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ —É–∫–∞–∑–∞–Ω–æ
if (product.name && product.name !== '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è') {
  updateData.name = product.name;
}
```

**–í–æ–ø—Ä–æ—Å:** –ß—Ç–æ –µ—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ –ø–æ–ª–µ "–ù–∞–∑–≤–∞–Ω–∏–µ" –ø—É—Å—Ç–æ–µ?
- –°–µ–π—á–∞—Å: –Ω–∞–∑–≤–∞–Ω–∏–µ –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –æ—Å—Ç–∞–µ—Ç—Å—è —Å—Ç–∞—Ä–æ–µ ‚úÖ
- –ù–æ: –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ –ø–æ–ª—è —à–∞–±–ª–æ–Ω–∞, –∞ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Ñ–∞–π–ª–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–õ–û–ì–ò–ö–ê –ü–†–ê–í–ò–õ–¨–ù–ê–Ø** (–Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ)

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è

**–î–µ—Ç–∞–ª–∏:**
- –¢–æ–≤–∞—Ä –Ω–∞–π–¥–µ–Ω –≤ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 393)
- –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 430)
- –ù–æ `catalog_category_id` –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ `updateData`

**–í–æ–ø—Ä–æ—Å:** –î–æ–ª–∂–Ω–∞ –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ?

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
- SKU —É–Ω–∏–∫–∞–ª–µ–Ω –≤–æ –≤—Å–µ–π –ë–î
- –¢–æ–≤–∞—Ä –Ω–∞–π–¥–µ–Ω ‚Üí –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å–≤–æ–π—Å—Ç–≤–∞
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–µ–π

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç–µ —Ç–æ–≤–∞—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ B, –Ω–æ SKU —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A
- –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–∏—Ç—Å—è, –Ω–æ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A
- –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üö® **–í–´–°–û–ö–ê–Ø** (–Ω—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê 6: –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–ª–µ–π –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 418-425):**
```javascript
const fixedKeys = fixFieldsEncoding(Object.keys(product.properties_data));
Object.keys(product.properties_data).forEach((originalKey, index) => {
  const fixedKey = fixedKeys[index];
  const value = product.properties_data[originalKey];
  if (value !== undefined && value !== null && value !== '' && value !== '-') {
    newProperties[fixedKey] = value;
  }
});
```

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- `product.properties_data` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—è –∏–∑ —à–∞–±–ª–æ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ —Ñ–∞–π–ª–µ
- –ü—É—Å—Ç—ã–µ –ø–æ–ª—è —É–∂–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã –Ω–∞ —ç—Ç–∞–ø–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—Å—Ç—Ä–æ–∫–∏ 199-212)
- –ó–Ω–∞—á–∏—Ç, –≤ `product.properties_data` –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è ‚úÖ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–õ–û–ì–ò–ö–ê –ü–†–ê–í–ò–õ–¨–ù–ê–Ø**

---

## üì∏ –ò–ú–ü–û–†–¢ –§–û–¢–û

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –∏–º–ø–æ—Ä—Ç–∞ —Ñ–æ—Ç–æ

**–§–∞–π–ª:** `app/api/admin/import/photos/route.ts`

**–¢–∏–ø—ã –∑–∞–≥—Ä—É–∑–∫–∏:**
1. **`property`** - —Ñ–æ—Ç–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º (property_photos)
2. **`product`** - —Ñ–æ—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ properties_data —Ç–æ–≤–∞—Ä–æ–≤

**–õ–æ–≥–∏–∫–∞:**

#### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ñ–æ—Ç–æ (—Å—Ç—Ä–æ–∫–∏ 177-242)
- –û–±–ª–æ–∂–∫–∞: —Ñ–∞–π–ª –±–µ–∑ —Å—É—Ñ—Ñ–∏–∫—Å–∞ `_N` –≤ –∫–æ–Ω—Ü–µ
- –ì–∞–ª–µ—Ä–µ—è: —Ñ–∞–π–ª —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `_N` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `base_1_1.png`)

#### 2. –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º (—Å—Ç—Ä–æ–∫–∏ 251-334)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `upsertPropertyPhoto()`
- –§–æ—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `property_photos`
- –ü—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞

#### 3. –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Ç–æ–≤–∞—Ä–∞–º (—Å—Ç—Ä–æ–∫–∏ 336-469)
- –§–æ—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `properties_data.photos` —Ç–æ–≤–∞—Ä–æ–≤
- –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å–≤–æ–π—Å—Ç–≤—É `mappingProperty`
- –û–±–ª–æ–∂–∫–∞ ‚Üí `photos.cover`
- –ì–∞–ª–µ—Ä–µ—è ‚Üí `photos.gallery[N]`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–ê–ï–¢**

---

## üéØ –ò–¢–û–ì–û–í–´–ô –í–´–í–û–î

### ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º: **100%**

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
1. ‚úÖ –ü—É—Å—Ç–æ–π SKU ‚Üí –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ SKU –≤–æ –≤—Å–µ–π –ë–î
3. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ–π –∏–∑ —à–∞–±–ª–æ–Ω–∞
4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–º SKU
5. ‚úÖ –ü—É—Å—Ç—ã–µ –ø–æ–ª—è –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç –ë–î
6. ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
7. ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å SKU –≤–æ –≤—Å–µ–π –ë–î

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è:

1. **üö® –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:**
   - –î–æ–ª–∂–Ω–∞ –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è?
   - –ò–ª–∏ —Ç–æ–≤–∞—Ä –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ —Å—Ç–∞—Ä–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏?
   - –ò–ª–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞?

2. **‚ö†Ô∏è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SKU:**
   - –î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ
   - –ù—É–∂–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è?

### üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–£—Ç–æ—á–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** –ø—Ä–∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–º SKU –≤ –¥—Ä—É–≥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏** –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö SKU (batch –ø—Ä–æ–≤–µ—Ä–∫–∞)
3. **–î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏–º–ø–æ—Ä—Ç–∞: "–û–±–Ω–æ–≤–ª—è—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–æ–≤–∞—Ä–∞ –ø—Ä–∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–º SKU?"

---

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ **–õ–û–ì–ò–ö–ê –°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢ –¢–†–ï–ë–û–í–ê–ù–ò–Ø–ú**  
**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢–°–Ø –£–¢–û–ß–ù–ï–ù–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–ô**

