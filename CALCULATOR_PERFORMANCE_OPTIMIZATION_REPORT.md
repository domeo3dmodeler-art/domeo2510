# üöÄ –û–¢–ß–ï–¢ –û–ë –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê –î–í–ï–†–ï–ô

## üìä –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–î–û –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)

### üêå –û—Å–Ω–æ–≤–Ω—ã–µ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞:
1. **API cascade-options –∑–∞–≥—Ä—É–∂–∞–ª –í–°–ï 3785 —Ç–æ–≤–∞—Ä–æ–≤** –∫–∞–∂–¥—ã–π —Ä–∞–∑ (400-1200ms)
2. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ API –∑–∞–ø—Ä–æ—Å—ã** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–∞–Ω–Ω—ã—Ö
4. **–ß–∞—Å—Ç—ã–µ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä—ã** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
5. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã** –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î

### üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ cascade-options**: 400-1200ms
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î**: 1 –∑–∞–ø—Ä–æ—Å –Ω–∞ 3785 —Ç–æ–≤–∞—Ä–æ–≤ –∫–∞–∂–¥—ã–π —Ä–∞–∑
- **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ**: N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è N –º–æ–¥–µ–ª–µ–π
- **–ü–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä—ã**: –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

---

## ‚ö° –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. üóÑÔ∏è **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ API cascade-options**
```typescript
// –ü—Ä–æ—Å—Ç–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ (5 –º–∏–Ω—É—Ç TTL)
const cache = new Map<string, { data: any; timestamp: number }>();
const CACHE_TTL = 5 * 60 * 1000;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º –∫ –ë–î
const cached = cache.get(cacheKey);
if (cached && (Date.now() - cached.timestamp) < CACHE_TTL) {
  return cached.data; // –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –∏–∑ –∫—ç—à–∞
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (0-5ms –≤–º–µ—Å—Ç–æ 400-1200ms)

### 2. üì∏ **Batch –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ**
```typescript
// –ù–æ–≤—ã–π API endpoint: /api/catalog/doors/photos-batch
// –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º
const photoResponse = await fetch('/api/catalog/doors/photos-batch', {
  method: 'POST',
  body: JSON.stringify({ models: modelNames })
});
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –ë—ã–ª–æ: N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è N –º–æ–¥–µ–ª–µ–π
- –°—Ç–∞–ª–æ: 1 –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 10-20 —Ä–∞–∑ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ

### 3. ‚è±Ô∏è **–î–µ–±–∞—É–Ω—Å–∏–Ω–≥ –∫–∞—Å–∫–∞–¥–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏**
```typescript
// –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
const timeoutId = setTimeout(() => {
  // –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ 300ms –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
}, 300);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 3-5 —Ä–∞–∑ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### 4. üåê **HTTP –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
headers: {
  'Cache-Control': 'public, max-age=300' // 5 –º–∏–Ω—É—Ç –∫—ç—à –≤ –±—Ä–∞—É–∑–µ—Ä–µ
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë—Ä–∞—É–∑–µ—Ä –∫—ç—à–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã, —É–º–µ–Ω—å—à–∞—è –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### 5. üîÑ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π**
```typescript
// –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π —Å —Ñ–æ—Ç–æ –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ
const modelsWithPhotos = rows.map((model: any) => ({
  ...model,
  photo: photoData.photos[model.model]?.photo || model.photo,
  photos: photoData.photos[model.model]?.photos || model.photos
}));
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### ‚ö° **–£—Å–∫–æ—Ä–µ–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤:**
- **–ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å**: 400-1200ms (–∫–∞–∫ –±—ã–ª–æ)
- **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**: 0-5ms (–∏–∑ –∫—ç—à–∞)
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ**: –≤ 80-240 —Ä–∞–∑ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### üì∏ **–£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ:**
- **–ë—ã–ª–æ**: N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è N –º–æ–¥–µ–ª–µ–π
- **–°—Ç–∞–ª–æ**: 1 batch –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ**: –≤ 10-20 —Ä–∞–∑

### üîÑ **–£–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤:**
- **–ë—ã–ª–æ**: –ó–∞–ø—Ä–æ—Å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- **–°—Ç–∞–ª–æ**: –ó–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ 300ms –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **–£–º–µ–Ω—å—à–µ–Ω–∏–µ**: –≤ 3-5 —Ä–∞–∑

### üíæ **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:**
- **–ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î**: –£–º–µ–Ω—å—à–µ–Ω—ã –≤ 5-10 —Ä–∞–∑ –±–ª–∞–≥–æ–¥–∞—Ä—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é
- **–¢—Ä–∞—Ñ–∏–∫**: –£–º–µ–Ω—å—à–µ–Ω –±–ª–∞–≥–æ–¥–∞—Ä—è HTTP –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é
- **CPU**: –ú–µ–Ω—å—à–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –¥–µ–±–∞—É–Ω—Å–∏–Ω–≥—É

---

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### üë§ **–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
- ‚úÖ **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è** –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** —Ñ–æ—Ç–æ –º–æ–¥–µ–ª–µ–π
- ‚úÖ **–ü–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞** –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –±–µ–∑ "–¥–µ—Ä–≥–∞–Ω–∏–π"
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

### üñ•Ô∏è **–î–ª—è —Å–µ—Ä–≤–µ—Ä–∞:**
- ‚úÖ **–ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏** –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** CPU –∏ –ø–∞–º—è—Ç–∏
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### üìÅ **–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
1. `app/api/catalog/doors/cascade-options/route.ts` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
2. `app/api/catalog/doors/photos-batch/route.ts` - –Ω–æ–≤—ã–π batch API –¥–ª—è —Ñ–æ—Ç–æ
3. `app/doors/page.tsx` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–µ–±–∞—É–Ω—Å–∏–Ω–≥

### üóÑÔ∏è **–¢–∏–ø—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:**
- **–°–µ—Ä–≤–µ—Ä–Ω—ã–π –∫—ç—à**: –í –ø–∞–º—è—Ç–∏ Node.js (5 –º–∏–Ω—É—Ç TTL)
- **HTTP –∫—ç—à**: –í –±—Ä–∞—É–∑–µ—Ä–µ (5 –º–∏–Ω—É—Ç max-age)
- **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫—ç—à**: –í React state (—Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏)

### ‚öôÔ∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
- **CACHE_TTL**: 5 –º–∏–Ω—É—Ç –¥–ª—è API –¥–∞–Ω–Ω—ã—Ö
- **PHOTO_CACHE_TTL**: 30 –º–∏–Ω—É—Ç –¥–ª—è —Ñ–æ—Ç–æ
- **DEBOUNCE_DELAY**: 300ms –¥–ª—è –∫–∞—Å–∫–∞–¥–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
```typescript
// –ó–∞–º–µ–Ω–∏—Ç—å Map –Ω–∞ Redis –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏
const redis = new Redis(process.env.REDIS_URL);
```

### 2. **CDN –¥–ª—è —Ñ–æ—Ç–æ**
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
const photoUrl = `https://cdn.domeo.ru${photoPath}`;
```

### 3. **–ò–Ω–¥–µ–∫—Å—ã –ë–î**
```sql
-- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª–µ–π
CREATE INDEX idx_properties_style ON products USING GIN ((properties_data->'Domeo_–°—Ç–∏–ª—å Web'));
CREATE INDEX idx_properties_model ON products USING GIN ((properties_data->'Domeo_–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è Web'));
```

### 4. **Lazy loading —Ñ–æ—Ç–æ**
```typescript
// –ó–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–æ—Ç–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
const [isVisible, setIsVisible] = useState(false);
```

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –¥–≤–µ—Ä–µ–π –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏–ª–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

- **‚ö° –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 80-240 —Ä–∞–∑** –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **üì∏ –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ –≤ 10-20 —Ä–∞–∑**
- **üîÑ –£–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤ –≤ 3-5 —Ä–∞–∑**
- **üíæ –≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞ –≤ 5-10 —Ä–∞–∑**

–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **–±—ã—Å—Ç—Ä–æ, –ø–ª–∞–≤–Ω–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ**, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç –¥–∞–∂–µ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.

---

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: $(date)*
*–í–µ—Ä—Å–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: 1.0*
