# ‚úÖ –†–ï–®–ï–ù–ò–ï: –ì–¥–µ –ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥

## üìä –ß—Ç–æ –º—ã —Å–¥–µ–ª–∞–ª–∏:

1. ‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—ã–ª `unhealthy` –Ω–∞ –í–ú
2. ‚úÖ **–ü—Ä–∏—á–∏–Ω–∞**: –í Dockerfile –Ω–µ –±—ã–ª–æ `curl` –¥–ª—è health check
3. ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏–ª–∏ `curl` –≤ Dockerfile.staging **–ª–æ–∫–∞–ª—å–Ω–æ**
4. ‚úÖ **–î–µ–ø–ª–æ–π**: –ó–∞–ø—É—à–∏–ª–∏ –≤ Git ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏–ª–∏ –í–ú
5. ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–µ–ø–µ—Ä—å `healthy` ‚úÖ

---

## üéØ –û–¢–í–ï–¢ –ù–ê –í–ê–® –í–û–ü–†–û–°:

### **–ì–¥–µ –ø—Ä–∞–≤–∏—Ç—å?**

# ‚úÖ **–ü–†–ê–í–ò–¢–¨ –õ–û–ö–ê–õ–¨–ù–û**

### Workflow:

```bash
# 1. –ü—Ä–∞–≤–∏–º –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ
# –ù–∞–ø—Ä–∏–º–µ—Ä: Dockerfile.staging, app/api/auth/route.ts, etc.

# 2. –ö–æ–º–º–∏—Ç–∏–º
git add .
git commit -m "Fix: –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã"
git push origin develop

# 3. –ù–∞ –í–ú –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è
# (—á–µ—Ä–µ–∑ GitHub Actions –∏–ª–∏ –≤—Ä—É—á–Ω—É—é)
```

---

## üìù –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä (–∫–æ—Ç–æ—Ä—ã–π –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–¥–µ–ª–∞–ª–∏):

### –®–∞–≥ 1: –ü—Ä–∞–≤–∏–º –ª–æ–∫–∞–ª—å–Ω–æ

```dockerfile
# Dockerfile.staging (—Å—Ç—Ä–æ–∫–∞ 34)
RUN apk add --no-cache openssl libc6-compat curl  # ‚Üê –¥–æ–±–∞–≤–∏–ª–∏ curl
```

### –®–∞–≥ 2: –ö–æ–º–º–∏—Ç–∏–º –∏ –ø—É—à–∏–º

```bash
git add Dockerfile.staging
git commit -m "Fix: Add curl to Docker image for health check"
git push origin develop
```

### –®–∞–≥ 3: –û–±–Ω–æ–≤–ª—è–µ–º –í–ú

```bash
ssh ubuntu@130.193.40.35 "cd /opt/domeo && git pull && docker compose -f docker-compose.staging.yml up -d --build"
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
# –°—Ç–∞—Ç—É—Å: healthy ‚úÖ
docker compose -f docker-compose.staging.yml ps
```

---

## üöÄ –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–û–ï –ü–†–ê–í–ò–õ–û:

### ‚úÖ –ü—Ä–∞–≤–∏–º –ª–æ–∫–∞–ª—å–Ω–æ, –¥–µ–ø–ª–æ–∏–º —á–µ—Ä–µ–∑ Git

**–ü–æ—á–µ–º—É?**

1. ‚úÖ **–õ–æ–∫–∞–ª—å–Ω–æ** - —É –≤–∞—Å IDE, –æ—Ç–ª–∞–¥–∫–∞, hot reload
2. ‚úÖ **Git** - –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. ‚úÖ **–í–ú** - production-like –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤

### ‚ùå –ù–ï –ø—Ä–∞–≤–∏–º –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ –í–ú

**–ü–æ—á–µ–º—É?**

1. ‚ùå –ù–µ—Ç IDE –∏ —É–¥–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
2. ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –ø–æ—Ç–µ—Ä—è—Ç—å—Å—è
3. ‚ùå –¢—Ä—É–¥–Ω–µ–µ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å

---

## üìã –ö–û–ì–î–ê –ß–¢–û –ü–†–ê–í–ò–¢–¨:

| –ì–¥–µ | –ß—Ç–æ –ø—Ä–∞–≤–∏—Ç—å | –ü—Ä–∏–º–µ—Ä |
|-----|-------------|--------|
| üîß **–õ–æ–∫–∞–ª—å–Ω–æ** | –ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | `app/api/auth/route.ts` |
| üîß **–õ–æ–∫–∞–ª—å–Ω–æ** | Dockerfile | `Dockerfile.staging` |
| üîß **–õ–æ–∫–∞–ª—å–Ω–æ** | Package.json | `dependencies` |
| ‚öôÔ∏è **–ù–∞ –í–ú** | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | `.env` —Ñ–∞–π–ª |
| ‚öôÔ∏è **–ù–∞ –í–ú** | –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î | `npx prisma migrate deploy` |

---

## üéØ –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï:

- ‚úÖ **–í–ú**: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä healthy
- ‚úÖ **Git**: –ö–æ–¥ –≤ develop
- ‚úÖ **–î–µ–ø–ª–æ–π**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π
- ‚è≥ **–õ–æ–∫–∞–ª—å–Ω–æ**: –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## üöÄ –ß–¢–û –î–ê–õ–¨–®–ï?

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

```bash
# 1. –ü—Ä–∞–≤–∏–º –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ
code app/api/auth/route.ts

# 2. –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ build
npm run build

# 3. –ü—É—à–∏–º –Ω–∞ staging
git push origin develop

# 4. –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ –í–ú
curl https://your-domain/api/auth
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)

```bash
# 1. –ó–∞–ø—É—Å–∫–∞–µ–º Docker Compose –ª–æ–∫–∞–ª—å–Ω–æ
docker compose -f docker-compose.local.yml up -d

# 2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
npx prisma generate
npx prisma db push

# 3. –†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
npm run dev

# 4. –¢–µ—Å—Ç–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
http://localhost:3000

# 5. –ü—É—à–∏–º –Ω–∞ staging
git push origin develop
```

---

## ‚ú® –†–ï–ó–Æ–ú–ï:

1. ‚úÖ **–ü—Ä–∞–≤–∏–º –õ–û–ö–ê–õ–¨–ù–û** - —Ç–∞–º —É –≤–∞—Å –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
2. ‚úÖ **–ü—É—à–∏–º –≤ Git** - –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
3. ‚úÖ **–î–µ–ø–ª–æ–∏–º –Ω–∞ –í–ú** - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ production-like –æ–∫—Ä—É–∂–µ–Ω–∏–∏
4. ‚úÖ **–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–∞–≤–∏–º –ø–æ —Ç–æ–º—É –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø—É**

**–í–æ–ø—Ä–æ—Å—ã?** üòä

