# üîÑ –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

## üìã –¶–µ–ø–æ—á–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:

```
–ö–ü (Quote) 
  ‚Üì quote_id
–°—á–µ—Ç (Invoice) ‚Üê quote_id
  ‚Üì invoice_id
–ó–∞–∫–∞–∑ (Order) ‚Üê quote_id + invoice_id
  ‚Üì order_id
–ó–∞–∫–∞–∑ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (SupplierOrder) ‚Üê order_id + invoice_id
```

## üéØ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ —Å–≤—è–∑–µ–π:

### 1. Quote (–ö–ü) - –ò—Å—Ö–æ–¥–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
- `id: string` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID)
- `quote_id: null` (–∏—Å—Ö–æ–¥–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç)
- `client_id: string`
- **–°–≤—è–∑–∏:** ‚Üí Invoice (—á–µ—Ä–µ–∑ quote_id)

### 2. Invoice (–°—á–µ—Ç) - –ù–∞ –æ—Å–Ω–æ–≤–µ –ö–ü
- `id: string` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID)
- `quote_id: string` (—Å—Å—ã–ª–∫–∞ –Ω–∞ –ö–ü)
- `order_id: string` (—Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∑–∞–∫–∞–∑)
- `client_id: string`
- **–°–≤—è–∑–∏:** ‚Üê Quote, ‚Üí Order (—á–µ—Ä–µ–∑ order_id)

### 3. Order (–ó–∞–∫–∞–∑) - –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç
- `id: string` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID)
- `quote_id: string` (—Å—Å—ã–ª–∫–∞ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—É—é –ö–ü)
- `invoice_id: string` (—Å—Å—ã–ª–∫–∞ –Ω–∞ —Å—á–µ—Ç)
- `client_id: string`
- **–°–≤—è–∑–∏:** ‚Üê Quote, ‚Üê Invoice, ‚Üí SupplierOrder

### 4. SupplierOrder (–ó–∞–∫–∞–∑ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞)
- `id: string` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID)
- `order_id: string` (—Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∑–∞–∫–∞–∑)
- `invoice_id: string` (—Å—Å—ã–ª–∫–∞ –Ω–∞ —Å—á–µ—Ç)
- `executor_id: string`
- **–°–≤—è–∑–∏:** ‚Üê Order, ‚Üê Invoice

## üîó –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏:

### ‚úÖ –ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç—å:
- –û—Ç –ö–ü –¥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ - –ø–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞
- –ö–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –∑–Ω–∞–µ—Ç –æ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö
- –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

### ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å:
- –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å—á–µ—Ç –±–µ–∑ –ö–ü (–ø—Ä—è–º–æ–π –∑–∞–∫–∞–∑)
- –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –±–µ–∑ —Å—á–µ—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### ‚úÖ –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å:
- –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —Ü–µ–ø–æ—á–∫–∞–º
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

## üöÄ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞
1. **–ö–ü** ‚Üí –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç
2. **–°—á–µ—Ç** (quote_id = –ö–ü.id) ‚Üí –∫–ª–∏–µ–Ω—Ç –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç
3. **–ó–∞–∫–∞–∑** (quote_id = –ö–ü.id, invoice_id = –°—á–µ—Ç.id) ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. **–ó–∞–∫–∞–∑ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞** (order_id = –ó–∞–∫–∞–∑.id, invoice_id = –°—á–µ—Ç.id)

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä—è–º–æ–π –∑–∞–∫–∞–∑
1. **–°—á–µ—Ç** (quote_id = null) ‚Üí –∫–ª–∏–µ–Ω—Ç –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç
2. **–ó–∞–∫–∞–∑** (quote_id = null, invoice_id = –°—á–µ—Ç.id)
3. **–ó–∞–∫–∞–∑ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞** (order_id = –ó–∞–∫–∞–∑.id, invoice_id = –°—á–µ—Ç.id)

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ó–∞–∫–∞–∑ –±–µ–∑ —Å—á–µ—Ç–∞
1. **–ö–ü** ‚Üí –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç
2. **–ó–∞–∫–∞–∑** (quote_id = –ö–ü.id, invoice_id = null)
3. **–ó–∞–∫–∞–∑ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞** (order_id = –ó–∞–∫–∞–∑.id, invoice_id = null)

## üìä API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–≤—è–∑—è–º–∏:

### –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é —Ü–µ–ø–æ—á–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–∞:
```
GET /api/documents/{id}/chain
```

### –ü–æ–ª—É—á–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:
```
GET /api/documents/{id}/related?type=all|quote|invoice|order|supplier_order
```

### –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–≤—è–∑—è–º–∏:
```
POST /api/documents/chain
{
  "type": "invoice",
  "quote_id": "quote_id",
  "client_id": "client_id",
  "items": [...]
}
```
