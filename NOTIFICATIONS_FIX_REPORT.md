# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ª–æ–≥–∏–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `lib/notifications/status-notifications.ts`

#### Invoice (–°—á–µ—Ç–∞):
- ‚úÖ **PAID** - –ø–æ–ª—É—á–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω–µ–Ω —Å `complectator` –Ω–∞ `executor`
- ‚úÖ –£–¥–∞–ª–µ–Ω —Å—Ç–∞—Ç—É—Å `IN_PRODUCTION` (–∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `ORDERED`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å `ORDERED` - –ø–æ–ª—É—á–∞—Ç–µ–ª—å: `complectator`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å `RECEIVED_FROM_SUPPLIER` - –ø–æ–ª—É—á–∞—Ç–µ–ª—å: `complectator`

#### Order (–ó–∞–∫–∞–∑—ã):
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ç—É—Å—ã `IN_PRODUCTION` –∏ `READY`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å `RECEIVED_FROM_SUPPLIER` - –ø–æ–ª—É—á–∞—Ç–µ–ª—å: `complectator`

#### SupplierOrder (–ó–∞–∫–∞–∑—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫—É):
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ç—É—Å—ã `IN_PRODUCTION` –∏ `READY`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å `RECEIVED_FROM_SUPPLIER` - –ø–æ–ª—É—á–∞—Ç–µ–ª—å: `complectator`
- ‚úÖ `ORDERED` –ø–æ–ª—É—á–∞—Ç–µ–ª—å: `complectator`
- ‚úÖ `COMPLETED` –ø–æ–ª—É—á–∞—Ç–µ–ª—å: `complectator`

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `app/api/supplier-orders/[id]/status/route.ts`

**–ü—Ä–æ–±–ª–µ–º–∞**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å —Ç–æ–ª—å–∫–æ `parentUser.id` (–æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)

**–†–µ—à–µ–Ω–∏–µ**: 
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `notifyUsersByRole` –∏–∑ `@/lib/notifications`
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ `prisma.notification.create()` –Ω–∞ `notifyUsersByRole('COMPLECTATOR', {...})`
- ‚úÖ –¢–µ–ø–µ—Ä—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—É—á–∞—é—Ç **–≤—Å–µ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä—ã**, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å —Å—á–µ—Ç–∞

**–ö–æ–¥ –¥–æ**:
```typescript
await prisma.notification.create({
  data: {
    user_id: parentUser.id,  // ‚ùå –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    client_id: invoice.client_id,
    document_id: invoice.id,
    type: 'STATUS_CHANGE',
    title: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞',
    message: invoiceInfo,
    is_read: false
  }
});
```

**–ö–æ–¥ –ø–æ—Å–ª–µ**:
```typescript
// –£–≤–µ–¥–æ–º–ª—è–µ–º –≤—Å–µ—Ö –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–æ–≤ ‚úÖ
await notifyUsersByRole('COMPLECTATOR', {
  clientId: invoice.client_id,
  documentId: invoice.id,
  type: 'status_changed',
  title: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞',
  message: invoiceInfo
});
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ `app/api/quotes/[id]/status/route.ts`

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –ö–ü —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –¥–≤—É—Ö —Å—Ç–∞—Ç—É—Å–æ–≤:

1. **SENT** (–ö–ü –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ):
   - –ü–æ–ª—É—á–∞—Ç–µ–ª—å: –∫–ª–∏–µ–Ω—Ç
   - –°–æ–æ–±—â–µ–Ω–∏–µ: "–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ [–Ω–æ–º–µ—Ä] –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤–∞–º."

2. **ACCEPTED** (–ö–ü –ø—Ä–∏–Ω—è—Ç–æ):
   - –ü–æ–ª—É—á–∞—Ç–µ–ª—å: –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä—ã
   - –°–æ–æ–±—â–µ–Ω–∏–µ: "–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω—è–ª –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ [–Ω–æ–º–µ—Ä]."

**–ö–æ–¥**:
```typescript
if (status === 'SENT') {
  await notifyUsersByRole('client', {
    clientId: quoteWithClient.client_id,
    documentId: id,
    type: 'quote_sent',
    title: '–ö–ü –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ',
    message: `–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ ${quoteWithClient.number} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤–∞–º.`
  });
} else if (status === 'ACCEPTED') {
  await notifyUsersByRole('complectator', {
    clientId: quoteWithClient.client_id,
    documentId: id,
    type: 'quote_accepted',
    title: '–ö–ü –ø—Ä–∏–Ω—è—Ç–æ',
    message: `–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω—è–ª –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ ${quoteWithClient.number}.`
  });
}
```

---

## üìä –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –°—á–µ—Ç (Invoice)
| –°—Ç–∞—Ç—É—Å | –ö—Ç–æ –º–µ–Ω—è–µ—Ç | –ö—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç | –°–æ–æ–±—â–µ–Ω–∏–µ |
|--------|------------|--------------|-----------|
| SENT | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | –ö–ª–∏–µ–Ω—Ç | "–í–∞–º –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —Å—á–µ—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É" |
| PAID | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å | "–°—á–µ—Ç –æ–ø–ª–∞—á–µ–Ω. –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞." |
| ORDERED | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (—á–µ—Ä–µ–∑ SupplierOrder) | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | "–ó–∞–∫–∞–∑ —Ä–∞–∑–º–µ—â–µ–Ω —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞." |
| RECEIVED_FROM_SUPPLIER | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (—á–µ—Ä–µ–∑ SupplierOrder) | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | "–¢–æ–≤–∞—Ä –ø–æ–ª—É—á–µ–Ω –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞." |
| COMPLETED | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å (—á–µ—Ä–µ–∑ SupplierOrder) | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä + –ö–ª–∏–µ–Ω—Ç | "–ó–∞–∫–∞–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω." |

### –ö–ü (Quote)
| –°—Ç–∞—Ç—É—Å | –ö—Ç–æ –º–µ–Ω—è–µ—Ç | –ö—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç | –°–æ–æ–±—â–µ–Ω–∏–µ |
|--------|------------|--------------|-----------|
| SENT | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | –ö–ª–∏–µ–Ω—Ç | "–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ [–Ω–æ–º–µ—Ä] –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤–∞–º." |
| ACCEPTED | –ö–ª–∏–µ–Ω—Ç/–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | "–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω—è–ª –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ [–Ω–æ–º–µ—Ä]." |
| REJECTED | –ö–ª–∏–µ–Ω—Ç/–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | "–ö–ª–∏–µ–Ω—Ç –æ—Ç–∫–ª–æ–Ω–∏–ª –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ" |

### –ó–∞–∫–∞–∑ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É (SupplierOrder)
| –°—Ç–∞—Ç—É—Å | –ö—Ç–æ –º–µ–Ω—è–µ—Ç | –ö—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç | –°–æ–æ–±—â–µ–Ω–∏–µ |
|--------|------------|--------------|-----------|
| ORDERED | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | "–ó–∞–∫–∞–∑ —Ä–∞–∑–º–µ—â–µ–Ω —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞." |
| RECEIVED_FROM_SUPPLIER | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | "–¢–æ–≤–∞—Ä –ø–æ–ª—É—á–µ–Ω –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞." |
| COMPLETED | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä | "–ó–∞–∫–∞–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–º." |

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

1. ‚úÖ –£–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Å—Ç–∞—Ç—É—Å—ã (`IN_PRODUCTION`, `READY`)
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã (`ORDERED`, `RECEIVED_FROM_SUPPLIER`)
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–æ–ª—É—á–∞—Ç–µ–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
4. ‚úÖ SupplierOrder —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ç–æ—Ä–∞–º
5. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è Quote
6. ‚úÖ –õ–æ–≥–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞ –≤–æ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–µ

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ staging
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ staging
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤

