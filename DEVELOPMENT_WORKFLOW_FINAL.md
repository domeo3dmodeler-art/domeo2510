# üöÄ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π Workflow –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Domeo

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ Domeo —Å —Ä—É—á–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏.

## üåê –°—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

| **–°—Ä–µ–¥–∞** | **URL** | **–ü–æ—Ä—Ç** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|-----------|---------|----------|----------------|
| **Production** | `http://130.193.40.35:3000` | 3000 | –†–∞–±–æ—á–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| **Staging** | `http://89.169.189.66:3001` | 3001 | –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ |

## üîÑ Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### **1. –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**

```bash
# –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
npm run lint
npm run type-check
```

### **2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏**

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ feature –≤–µ—Ç–∫–∏
npm run git:feature

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
git checkout -b feature/–Ω–∞–∑–≤–∞–Ω–∏–µ-—Ñ—É–Ω–∫—Ü–∏–∏
```

### **3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Staging**

```bash
# –î–µ–ø–ª–æ–π –Ω–∞ staging
npm run deploy:staging:safe

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
curl http://89.169.189.66:3001/api/health
```

### **4. –î–µ–ø–ª–æ–π –Ω–∞ Production**

```bash
# –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ staging!
npm run deploy:prod:safe
```

## üõ†Ô∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**
- `npm run dev` - –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- `npm run build` - —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- `npm run lint` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
- `npm run type-check` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤

### **Git Workflow**
- `npm run git:feature` - —Å–æ–∑–¥–∞–Ω–∏–µ feature –≤–µ—Ç–∫–∏
- `npm run git:status` - —Å—Ç–∞—Ç—É—Å Git
- `npm run workflow:status` - —Å—Ç–∞—Ç—É—Å workflow

### **–î–µ–ø–ª–æ–π**
- `npm run deploy:staging:safe` - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ staging
- `npm run deploy:prod:safe` - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ production
- `npm run rollback:prod` - –æ—Ç–∫–∞—Ç production

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
- `npm run health:staging` - –ø—Ä–æ–≤–µ—Ä–∫–∞ staging
- `npm run health:prod` - –ø—Ä–æ–≤–µ—Ä–∫–∞ production

## üîí –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### **‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï –î–ï–õ–ê–ô–¢–ï:**
1. **–ü—Ä—è–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ Production VM** - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã
2. **–î–µ–ø–ª–æ–π –Ω–∞ production –±–µ–∑ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ staging**
3. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö production –±–µ–∑ –±—ç–∫–∞–ø–∞**

### **‚úÖ –í–°–ï–ì–î–ê –î–ï–õ–ê–ô–¢–ï:**
1. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ staging** –ø–µ—Ä–µ–¥ production
2. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ feature –≤–µ—Ç–∫–∏** –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã** –¥–ª—è –¥–µ–ø–ª–æ—è
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ health check** –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

## üìä –ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### **–®–∞–≥ 1: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**
```bash
# –°–æ–∑–¥–∞–µ–º feature –≤–µ—Ç–∫—É
git checkout -b feature/new-feature

# –†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
npm run dev

# –ö–æ–º–º–∏—Ç–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "feat: add new feature"
git push origin feature/new-feature
```

### **–®–∞–≥ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
```bash
# –°–æ–∑–¥–∞–µ–º Pull Request –≤ develop
# –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤ develop:

# –î–µ–ø–ª–æ–∏–º –Ω–∞ staging
npm run deploy:staging:safe

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ http://89.169.189.66:3001
```

### **–®–∞–≥ 3: Production**
```bash
# –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!

# –ú–µ—Ä–∂–∏–º develop –≤ main
git checkout main
git merge develop
git tag v1.0.1
git push origin main --tags

# –î–µ–ø–ª–æ–∏–º –Ω–∞ production
npm run deploy:prod:safe

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ http://130.193.40.35:3000
```

## üîß –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å Production –Ω–∞ Staging**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
./scripts/sync-data-between-environments.sh production staging
```

### **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ Staging –Ω–∞ Production**
```bash
# –û–°–¢–û–†–û–ñ–ù–û! –¢–æ–ª—å–∫–æ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
./scripts/sync-data-between-environments.sh staging production
```

## üö® –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏

### **–û—Ç–∫–∞—Ç Production**
```bash
npm run rollback:prod
```

### **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞**
```bash
# –ù–∞ production VM
cd /opt/domeo
cp prisma/database/dev.db.backup-YYYYMMDD_HHMMSS prisma/database/dev.db
```

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

- **Production VM**: `130.193.40.35:3000`
- **Staging VM**: `89.169.189.66:3001`
- **SSH –∫–ª—é—á–∏**: `production_key`, `staging_key`

## üìù –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤**
```bash
# –ù–∞ VM
cd /opt/domeo  # –∏–ª–∏ /opt/domeo-staging
tail -f logs/app.log
```

### **Health Check**
```bash
# Staging
curl http://89.169.189.66:3001/api/health

# Production
curl http://130.193.40.35:3000/api/health
```

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –ø–æ –∫–æ–º–∞–Ω–¥–µ
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ staging –ø–µ—Ä–µ–¥ production
3. **–ö–æ–Ω—Ç—Ä–æ–ª—å** - –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–º –¥–µ–ø–ª–æ—è
4. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º

**–ü–æ–º–Ω–∏—Ç–µ: Production - —ç—Ç–æ —Å–≤—è—â–µ–Ω–Ω–∞—è –∫–æ—Ä–æ–≤–∞. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ç—Ä–æ–≥–∞–π—Ç–µ –µ—ë –Ω–∞–ø—Ä—è–º—É—é!**
