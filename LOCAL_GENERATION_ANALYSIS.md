# üîç –ê–ù–ê–õ–ò–ó: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –õ–û–ö–ê–õ–¨–ù–û

## üìä –¢–ï–ö–£–©–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø –õ–û–ö–ê–õ–¨–ù–û:

### ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
1. `puppeteer` - –µ—Å—Ç—å
2. `@sparticuz/chromium` - –µ—Å—Ç—å ‚úÖ
3. `exceljs` - –µ—Å—Ç—å

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
**Chrome –Ω–µ —Å–∫–∞—á–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ** (–Ω–µ—Ç `node_modules\puppeteer\local-chromium`)
**–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∏ —Å–µ—Ç–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

---

## üîç –ö–ê–ö –ü–†–û–ò–°–•–û–î–ò–¢ –ì–ï–ù–ï–†–ê–¶–ò–Ø:

### –¶–µ–ø–æ—á–∫–∞ –≤—ã–∑–æ–≤–æ–≤:

```
1. app/api/documents/generate/route.ts
   ‚îî‚îÄ‚îÄ> generatePDF() (—Å—Ç—Ä–æ–∫–∞ 10)
       ‚îî‚îÄ‚îÄ> puppeteer.launch() (–±–µ–∑ chromium) ‚ùå

2. lib/export/puppeteer-generator.ts  
   ‚îî‚îÄ‚îÄ> generatePDFWithPuppeteer() (—Å—Ç—Ä–æ–∫–∞ 177)
       ‚îî‚îÄ‚îÄ> puppeteer.launch() (–±–µ–∑ chromium) ‚ùå

3. ‚úÖ lib/pdf/htmlToPdf.ts
   ‚îî‚îÄ‚îÄ> htmlToPdfBuffer()
       ‚îî‚îÄ‚îÄ> puppeteer-core + @sparticuz/chromium ‚úÖ
```

---

## üéØ –ì–î–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø:

### ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–±–µ–∑ chromium):
- `app/api/documents/generate/route.ts` ‚Üí `generatePDF()`
- `lib/export/puppeteer-generator.ts` ‚Üí `generatePDFWithPuppeteer()`
- `app/api/export/fast/route.ts` ‚Üí `exportDocumentWithPDF()`

### ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Å chromium):
- `lib/pdf/htmlToPdf.ts` ‚Üí `htmlToPdfBuffer()`
- `app/lib/pdf/htmlToPdf.ts` ‚Üí –¥—É–±–ª–∏–∫–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üîç –î–ï–¢–ê–õ–¨–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –õ–û–ö–ê–õ–¨–ù–û:

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
‚úÖ puppeteer: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚ùå local-chromium: –ù–µ—Ç (Chrome –Ω–µ —Å–∫–∞—á–∞–ª—Å—è)
‚úÖ @sparticuz/chromium: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚úÖ exceljs: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```

### 2. –ö–æ–¥ –∫–æ—Ç–æ—Ä—ã–π –ù–ï –†–ê–ë–û–¢–ê–ï–¢ –ª–æ–∫–∞–ª—å–Ω–æ:

**–§–∞–π–ª:** `lib/export/puppeteer-generator.ts`
```typescript
// –°—Ç—Ä–æ–∫–∞ 3:
import puppeteer, { Browser } from 'puppeteer';  // ‚ùå –æ–±—ã—á–Ω—ã–π puppeteer

// –°—Ç—Ä–æ–∫–∞ 177:
const browser = await puppeteer.launch({  // ‚ùå –∏—â–µ—Ç Chrome –≤ —Å–∏—Å—Ç–µ–º–µ
  headless: true,
  args: [...]
});
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—â–µ—Ç Chrome –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –µ–≥–æ –Ω–µ—Ç

### 3. –ö–æ–¥ –∫–æ—Ç–æ—Ä—ã–π –î–û–õ–ñ–ï–ù —Ä–∞–±–æ—Ç–∞—Ç—å (–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):

**–§–∞–π–ª:** `lib/pdf/htmlToPdf.ts`
```typescript
// –°—Ç—Ä–æ–∫–∞ 1-2:
import chromium from '@sparticuz/chromium';  // ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç
import puppeteer from 'puppeteer-core';     // ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

// –°—Ç—Ä–æ–∫–∞ 29:
const browser = await puppeteer.launch({
  args: chromium.args,                      // ‚úÖ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç chromium
  executablePath: await chromium.executablePath(),  // ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å
  headless: true
});
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è! ‚ùå

---

## üîç –ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢ –õ–û–ö–ê–õ–¨–ù–û:

### –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF:

1. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `generatePDF()` –∏–ª–∏ `generatePDFWithPuppeteer()`
2. –ö–æ–¥ –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å `puppeteer.launch()`
3. Puppeteer –∏—â–µ—Ç Chrome –≤ —Å–∏—Å—Ç–µ–º–µ
4. ‚ùå Chrome –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí **–û–®–ò–ë–ö–ê**

### –ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ:
- –í–æ–∑–º–æ–∂–Ω–æ puppeteer —Å–∫–∞—á–∏–≤–∞–µ—Ç Chrome –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ò–õ–ò –≤–µ—Ä–Ω–µ—Ç—Å—è –æ—à–∏–±–∫–∞ "Could not find Chrome"

### –ù–∞ –í–ú (Docker Alpine):
- Chromium –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –æ–±—Ä–∞–∑–µ
- ‚ùå **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –û–®–ò–ë–ö–ê**

---

## üß™ –¢–ï–°–¢ –õ–û–ö–ê–õ–¨–ù–û:

### –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å PDF –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä
Get-Process node | Stop-Process

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ë–î
$env:DATABASE_URL="postgresql://domeo:domeo@localhost:5435/domeo"
npm run dev

# 3. –û—Ç–∫—Ä—ã—Ç—å http://localhost:3000
# 4. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞—Ç—å PDF
```

---

## üîç –û–ñ–ò–î–ê–ï–ú–´–ï –û–®–ò–ë–ö–ò:

### –û—à–∏–±–∫–∞ 1: "Could not find Chrome"
- **–ì–¥–µ:** –õ–æ–∫–∞–ª—å–Ω–æ
- **–ü—Ä–∏—á–∏–Ω–∞:** Chrome –Ω–µ —Å–∫–∞—á–∞–Ω
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@sparticuz/chromium`

### –û—à–∏–±–∫–∞ 2: "Table users does not exist"
- **–ì–¥–µ:** –õ–æ–∫–∞–ª—å–Ω–æ
- **–ü—Ä–∏—á–∏–Ω–∞:** –ë–î –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∞—Å—å –º–∏–≥—Ä–∞—Ü–∏—è
- **–†–µ—à–µ–Ω–æ:** –°—Ö–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ —Å –í–ú

### –û—à–∏–±–∫–∞ 3: Chrome –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ –í–ú
- **–ì–¥–µ:** –í–ú
- **–ü—Ä–∏—á–∏–Ω–∞:** Docker Alpine –±–µ–∑ Chromium
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@sparticuz/chromium`

---

## üìù –ò–¢–û–ì –õ–û–ö–ê–õ–¨–ù–û–ì–û –ê–ù–ê–õ–ò–ó–ê:

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- Prisma engines —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ExcelJS —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç Chrome)
- –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è

### ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
- PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (–Ω–µ—Ç Chrome)
- Puppeteer –∏—â–µ—Ç Chrome –≤ —Å–∏—Å—Ç–µ–º–µ

### üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@sparticuz/chromium` –≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–≥–æ `puppeteer`
2. –ò–õ–ò —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Chromium –≤ Docker

---

**–î–ï–õ–ê–¢–¨ –ü–û–ö–ê –ù–ï –ù–£–ñ–ù–û - —Ç–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑ ‚úÖ**

