# üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Hot Reload –Ω–∞ Staging

## üìã –®–ê–ì 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ

### 1.1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ staging –í–ú

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (PowerShell):**

```powershell
cd C:\01_conf\0411

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
.\scripts\setup-hot-reload.ps1
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/opt/domeo-staging` –Ω–∞ staging –í–ú
- ‚úÖ –°–∫–æ–ø–∏—Ä—É–µ—Ç `docker-compose.staging-dev.yml`
- ‚úÖ –°–∫–æ–ø–∏—Ä—É–µ—Ç —Å–∫—Ä–∏–ø—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

---

## üìã –®–ê–ì 2: –ó–∞–ø—É—Å–∫ –Ω–∞ staging –í–ú

**–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ staging –í–ú:**

```bash
ssh ubuntu@130.193.40.35
```

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ staging –í–ú:**

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/domeo-staging

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
docker compose -f docker-compose.staging.yml down 2>/dev/null || true

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å hot reload
docker compose -f docker-compose.staging-dev.yml up -d

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å dev —Å–µ—Ä–≤–µ—Ä)
docker compose -f docker-compose.staging-dev.yml logs -f staging-app
```

**–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**
```
üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
üîß –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client...
üöÄ –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø–æ—Ä—Ç—É 3001...
```

---

## üìã –®–ê–ì 3: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (PowerShell):**

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```powershell
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
.\scripts\sync-to-staging.ps1

# –° –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
.\scripts\sync-to-staging.ps1 -Force
```

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (—Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è)

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
.\scripts\sync-to-staging.ps1 -Watch
```

–¢–µ–ø–µ—Ä—å –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è!

---

## üìã –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä–∫–∞

### 4.1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ù–∞ staging –í–ú:**

```bash
docker compose -f docker-compose.staging-dev.yml ps
```

–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç–∞—Ç—É—Å `Up`.

### 4.2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
docker compose -f docker-compose.staging-dev.yml logs -f staging-app
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ Next.js dev —Å–µ—Ä–≤–µ—Ä–∞.

### 4.3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

**http://130.193.40.35:3001**

---

## üîÑ WORKFLOW –†–ê–ó–†–ê–ë–û–¢–ö–ò:

### –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:

1. **–ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `app/doors/page.tsx`)

2. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ** (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è):
   ```powershell
   .\scripts\sync-to-staging.ps1
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://130.193.40.35:3001

4. **Hot Reload –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É!

---

## üîß –£–ü–†–ê–í–õ–ï–ù–ò–ï:

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
# –ù–∞ staging –í–ú
docker compose -f docker-compose.staging-dev.yml down
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
# –ù–∞ staging –í–ú
docker compose -f docker-compose.staging-dev.yml restart staging-app
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
# –ù–∞ staging –í–ú
docker compose -f docker-compose.staging-dev.yml logs -f staging-app
```

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ build —Ä–µ–∂–∏–º:

```bash
# –ù–∞ staging –í–ú
docker compose -f docker-compose.staging-dev.yml down
docker compose -f docker-compose.staging.yml up -d
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û:

1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫** –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 2-5 –º–∏–Ω—É—Ç (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
2. **Prisma Client** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
3. **node_modules** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ volume - –Ω–µ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑
4. **.next –∫—ç—à** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è - —É—Å–∫–æ—Ä—è–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∏

---

## üêõ –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú:

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose -f docker-compose.staging-dev.yml logs staging-app

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose -f docker-compose.staging-dev.yml up -d --force-recreate
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–æ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª—ã –Ω–∞ staging –í–ú –æ–±–Ω–æ–≤–ª–µ–Ω—ã
ssh ubuntu@130.193.40.35 "ls -la /opt/domeo-staging/app/doors/"

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose -f docker-compose.staging-dev.yml restart staging-app
```

### –ü—Ä–æ–±–ª–µ–º–∞: Prisma Client –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ Prisma Client –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker compose -f docker-compose.staging-dev.yml exec staging-app npx prisma generate
```

---

## ‚úÖ –ì–û–¢–û–í–û!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å hot reload –Ω–∞ staging! üéâ

–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞!

